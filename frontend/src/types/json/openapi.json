{"openapi":"3.0.2","info":{"title":"FastAPI","version":"0.1.0"},"paths":{"/auth/login":{"post":{"summary":"Auth:Jwt.Login","operationId":"auth_jwt_login_auth_login_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_auth_jwt_login_auth_login_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/logout":{"post":{"summary":"Auth:Jwt.Logout","operationId":"auth_jwt_logout_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/auth/register":{"post":{"tags":["auth"],"summary":"Register","description":"注册时不能指定setting，使用默认setting","operationId":"register_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/user":{"get":{"tags":["user"],"summary":"Get All Users","operationId":"get_all_users_user_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/user/me":{"get":{"tags":["user"],"summary":"Get Me","operationId":"get_me_user_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]},"patch":{"tags":["user"],"summary":"Update Me","operationId":"update_me_user_me_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/user/{user_id}":{"get":{"tags":["user"],"summary":"Admin Get User","operationId":"admin_get_user_user__user_id__get","parameters":[{"required":true,"schema":{"title":"User Id","type":"integer"},"name":"user_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]},"delete":{"tags":["user"],"summary":"Admin Delete User","operationId":"admin_delete_user_user__user_id__delete","parameters":[{"required":true,"schema":{"title":"User Id","type":"integer"},"name":"user_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]},"patch":{"tags":["user"],"summary":"Admin Update User","operationId":"admin_update_user_user__user_id__patch","parameters":[{"required":true,"schema":{"title":"User Id","type":"integer"},"name":"user_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdateAdmin"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/user/{user_id}/setting":{"patch":{"tags":["user"],"summary":"Admin Update User Setting","operationId":"admin_update_user_setting_user__user_id__setting_patch","parameters":[{"required":true,"schema":{"title":"User Id","type":"integer"},"name":"user_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserSettingSchema"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv":{"get":{"tags":["conversation"],"summary":"Get My Conversations","description":"返回自己的有效会话","operationId":"get_my_conversations_conv_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]},"delete":{"tags":["conversation"],"summary":"Delete All Conversation","operationId":"delete_all_conversation_conv_delete","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/all":{"get":{"tags":["conversation"],"summary":"Get All Conversations","operationId":"get_all_conversations_conv_all_get","parameters":[{"required":false,"schema":{"title":"Valid Only","type":"boolean","default":false},"name":"valid_only","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/{conversation_id}":{"get":{"tags":["conversation"],"summary":"Get Conversation History","operationId":"get_conversation_history_conv__conversation_id__get","parameters":[{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]},"delete":{"tags":["conversation"],"summary":"Delete Conversation","description":"软删除：标记为 invalid 并且从 chatgpt 账号中删除会话，但不会删除 mongodb 中的历史记录","operationId":"delete_conversation_conv__conversation_id__delete","parameters":[{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]},"patch":{"tags":["conversation"],"summary":"Update Conversation Title","operationId":"update_conversation_title_conv__conversation_id__patch","parameters":[{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"},{"required":true,"schema":{"title":"Title","type":"string"},"name":"title","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/{conversation_id}/cache":{"get":{"tags":["conversation"],"summary":"Get Conversation History From Cache","operationId":"get_conversation_history_from_cache_conv__conversation_id__cache_get","parameters":[{"required":true,"schema":{"title":"Conversation Id"},"name":"conversation_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/{conversation_id}/vanish":{"delete":{"tags":["conversation"],"summary":"Vanish Conversation","description":"硬删除：删除数据库和账号中的对话和历史记录","operationId":"vanish_conversation_conv__conversation_id__vanish_delete","parameters":[{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/{conversation_id}/assign/{username}":{"patch":{"tags":["conversation"],"summary":"Assign Conversation","operationId":"assign_conversation_conv__conversation_id__assign__username__patch","parameters":[{"required":true,"schema":{"title":"Username","type":"string"},"name":"username","in":"path"},{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/conv/{conversation_id}/gen_title":{"patch":{"tags":["conversation"],"summary":"Generate Conversation Title","operationId":"generate_conversation_title_conv__conversation_id__gen_title_patch","parameters":[{"required":true,"schema":{"title":"Conversation Id","anyOf":[{"type":"string"},{"type":"string","format":"uuid"}]},"name":"conversation_id","in":"path"},{"required":true,"schema":{"title":"Message Id","type":"string"},"name":"message_id","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/chat/openai-plugins/all":{"get":{"tags":["chat"],"summary":"Get All Openai Web Chat Plugins","operationId":"get_all_openai_web_chat_plugins_chat_openai_plugins_all_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/chat/openai-plugins/installed":{"get":{"tags":["chat"],"summary":"Get Installed Openai Web Chat Plugins","operationId":"get_installed_openai_web_chat_plugins_chat_openai_plugins_installed_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/chat/openai-plugin/{plugin_id}":{"get":{"tags":["chat"],"summary":"Get Openai Web Plugin","operationId":"get_openai_web_plugin_chat_openai_plugin__plugin_id__get","parameters":[{"required":true,"schema":{"title":"Plugin Id","type":"string"},"name":"plugin_id","in":"path"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/chat/openai-plugin/{plugin_id}/user-settings":{"patch":{"tags":["chat"],"summary":"Update Chat Plugin User Settings","operationId":"update_chat_plugin_user_settings_chat_openai_plugin__plugin_id__user_settings_patch","parameters":[{"required":true,"schema":{"title":"Plugin Id","type":"string"},"name":"plugin_id","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OpenaiChatPluginUserSettings"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/chat/__schema_types":{"get":{"tags":["chat"],"summary":" Predict Schema Types","description":"只用来让 openapi 自动生成 schema，并不实际调用","operationId":"_predict_schema_types_chat___schema_types_get","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AskRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/system/info":{"get":{"tags":["system"],"summary":"Get System Info","operationId":"get_system_info_system_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/stats/request":{"get":{"tags":["system"],"summary":"Get Request Statistics","operationId":"get_request_statistics_system_stats_request_get","parameters":[{"required":false,"schema":{"title":"Granularity","type":"integer","default":1800},"name":"granularity","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/stats/ask":{"get":{"tags":["system"],"summary":"Get Ask Statistics","operationId":"get_ask_statistics_system_stats_ask_get","parameters":[{"required":false,"schema":{"title":"Granularity","type":"integer","default":1800},"name":"granularity","in":"query"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/logs/server":{"post":{"tags":["system"],"summary":"Get Server Logs","operationId":"get_server_logs_system_logs_server_post","requestBody":{"content":{"application/json":{"schema":{"title":"Options","allOf":[{"$ref":"#/components/schemas/LogFilterOptions"}],"default":{"max_lines":100}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/config":{"get":{"tags":["system"],"summary":"Get Config","operationId":"get_config_system_config_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]},"put":{"tags":["system"],"summary":"Update Config","operationId":"update_config_system_config_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfigModel"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/credentials":{"get":{"tags":["system"],"summary":"Get Credentials","operationId":"get_credentials_system_credentials_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]},"put":{"tags":["system"],"summary":"Update Credentials","operationId":"update_credentials_system_credentials_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialsModel"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/system/import-users":{"post":{"tags":["system"],"summary":"Import Users","description":"解析csv文件，导入用户\ncsv字段：","operationId":"import_users_system_import_users_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_import_users_system_import_users_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"APIKeyCookie":[]}]}},"/status/common":{"get":{"tags":["status"],"summary":"Get Server Status","description":"普通用户获取服务器状态","operationId":"get_server_status_status_common_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"string"}}}}},"security":[{"APIKeyCookie":[]}]}}},"components":{"schemas":{"AskLogAggregation":{"title":"AskLogAggregation","required":["count"],"type":"object","properties":{"_id":{"$ref":"#/components/schemas/AskLogAggregationID"},"count":{"title":"Count","type":"integer"},"user_ids":{"title":"User Ids","type":"array","items":{"type":"integer"}},"total_queueing_time":{"title":"Total Queueing Time","type":"number"},"total_ask_time":{"title":"Total Ask Time","type":"number"}}},"AskLogAggregationID":{"title":"AskLogAggregationID","required":["start_time"],"type":"object","properties":{"start_time":{"title":"Start Time","type":"string","format":"date-time"},"meta":{"title":"Meta","anyOf":[{"$ref":"#/components/schemas/OpenaiWebAskLogMeta"},{"$ref":"#/components/schemas/OpenaiApiAskLogMeta"}]}}},"AskRequest":{"title":"AskRequest","required":["source","model","new_conversation","content"],"type":"object","properties":{"source":{"$ref":"#/components/schemas/ChatSourceTypes"},"model":{"title":"Model","type":"string"},"new_conversation":{"title":"New Conversation","type":"boolean"},"new_title":{"title":"New Title","type":"string"},"conversation_id":{"title":"Conversation Id","type":"string","format":"uuid"},"parent":{"title":"Parent","type":"string","format":"uuid"},"api_context_message_count":{"title":"Api Context Message Count","minimum":-1.0,"type":"integer","default":-1},"content":{"title":"Content","type":"string"},"openai_web_plugin_ids":{"title":"Openai Web Plugin Ids","type":"array","items":{"type":"string"}}}},"AskResponse":{"title":"AskResponse","required":["type"],"type":"object","properties":{"type":{"$ref":"#/components/schemas/AskResponseType"},"tip":{"title":"Tip","type":"string"},"conversation_id":{"title":"Conversation Id","type":"string","format":"uuid"},"message":{"title":"Message","anyOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessage"},{"$ref":"#/components/schemas/OpenaiApiChatMessage"}]},"error_detail":{"title":"Error Detail","type":"string"}}},"AskResponseType":{"title":"AskResponseType","enum":["waiting","queueing","message","error"],"type":"string","description":"An enumeration."},"AuthSetting":{"title":"AuthSetting","type":"object","properties":{"jwt_secret":{"title":"Jwt Secret","type":"string","default":"MODIFY_THIS_TO_RANDOM_SECRET"},"jwt_lifetime_seconds":{"title":"Jwt Lifetime Seconds","minimum":1.0,"type":"integer","default":86400},"cookie_max_age":{"title":"Cookie Max Age","minimum":1.0,"type":"integer","default":86400},"cookie_name":{"title":"Cookie Name","type":"string","default":"user_auth"},"user_secret":{"title":"User Secret","type":"string","default":"MODIFY_THIS_TO_RANDOM_SECRET"}}},"BaseChatMessage":{"title":"BaseChatMessage","required":["id","source","role","children"],"type":"object","properties":{"id":{"title":"Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_web","openai_api"],"type":"string"},"role":{"title":"Role","anyOf":[{"enum":["system","user","assistant","tool"],"type":"string"},{"type":"string"}]},"author_name":{"title":"Author Name","anyOf":[{"enum":["browser"],"type":"string"},{"type":"string"}]},"model":{"title":"Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"parent":{"title":"Parent","type":"string","format":"uuid"},"children":{"title":"Children","type":"array","items":{"type":"string","format":"uuid"}},"content":{"title":"Content","anyOf":[{"oneOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessageTextContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageCodeContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageStderrContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageTetherBrowsingDisplayContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageTetherQuoteContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageSystemErrorContent"}]},{"$ref":"#/components/schemas/OpenaiApiChatMessageTextContent"},{"type":"string"}]},"metadata":{"title":"Metadata","anyOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadata"},{"$ref":"#/components/schemas/OpenaiApiChatMessageMetadata"}]}}},"BaseConversationHistory":{"title":"BaseConversationHistory","required":["source","title","create_time","update_time","mapping"],"type":"object","properties":{"_id":{"title":" Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_web","openai_api"],"type":"string"},"title":{"title":"Title","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"},"mapping":{"title":"Mapping","type":"object","additionalProperties":{"$ref":"#/components/schemas/BaseChatMessage"}},"current_node":{"title":"Current Node","type":"string","format":"uuid"},"current_model":{"title":"Current Model","type":"string"},"metadata":{"title":"Metadata","anyOf":[{"$ref":"#/components/schemas/OpenaiWebConversationHistoryMeta"},{"$ref":"#/components/schemas/OpenaiApiConversationHistoryMeta"}]}}},"BaseConversationSchema":{"title":"BaseConversationSchema","required":["source"],"type":"object","properties":{"id":{"title":"Id","type":"integer","default":-1},"source":{"$ref":"#/components/schemas/ChatSourceTypes"},"conversation_id":{"title":"Conversation Id","type":"string","format":"uuid"},"title":{"title":"Title","type":"string"},"user_id":{"title":"User Id","type":"integer"},"is_valid":{"title":"Is Valid","type":"boolean","default":true},"current_model":{"title":"Current Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"}}},"Body_auth_jwt_login_auth_login_post":{"title":"Body_auth_jwt_login_auth_login_post","required":["username","password"],"type":"object","properties":{"grant_type":{"title":"Grant Type","pattern":"password","type":"string"},"username":{"title":"Username","type":"string"},"password":{"title":"Password","type":"string"},"scope":{"title":"Scope","type":"string","default":""},"client_id":{"title":"Client Id","type":"string"},"client_secret":{"title":"Client Secret","type":"string"}}},"Body_import_users_system_import_users_post":{"title":"Body_import_users_system_import_users_post","required":["file"],"type":"object","properties":{"file":{"title":"File","type":"string","format":"binary"}}},"ChatSourceTypes":{"title":"ChatSourceTypes","enum":["openai_web","openai_api"],"type":"string","description":"An enumeration."},"CommonSetting":{"title":"CommonSetting","type":"object","properties":{"sync_conversations_on_startup":{"title":"Sync Conversations On Startup","type":"boolean","default":true},"sync_conversations_regularly":{"title":"Sync Conversations Regularly","type":"boolean","default":false},"print_sql":{"title":"Print Sql","type":"boolean","default":false},"create_initial_admin_user":{"title":"Create Initial Admin User","type":"boolean","default":true},"initial_admin_user_username":{"title":"Initial Admin User Username","type":"string","default":"admin"},"initial_admin_user_password":{"title":"Initial Admin User Password","type":"string","default":"password"}}},"CommonStatusSchema":{"title":"CommonStatusSchema","type":"object","properties":{"active_user_in_5m":{"title":"Active User In 5M","type":"integer"},"active_user_in_1h":{"title":"Active User In 1H","type":"integer"},"active_user_in_1d":{"title":"Active User In 1D","type":"integer"},"is_chatbot_busy":{"title":"Is Chatbot Busy","type":"boolean"},"chatbot_waiting_count":{"title":"Chatbot Waiting Count","type":"integer"},"gpt4_count_in_3_hours":{"title":"Gpt4 Count In 3 Hours","type":"integer"}}},"ConfigModel":{"title":"ConfigModel","type":"object","properties":{"openai_web":{"title":"Openai Web","allOf":[{"$ref":"#/components/schemas/OpenaiWebChatGPTSetting"}],"default":{"enabled":true,"is_plus_account":true,"common_timeout":10,"ask_timeout":600,"enabled_models":["gpt_3_5","gpt_4","gpt_4_browsing","gpt_4_plugins"],"model_code_mapping":{"gpt_3_5":"text-davinci-002-render-sha","gpt_3_5_mobile":"text-davinci-002-render-sha-mobile","gpt_4":"gpt-4","gpt_4_mobile":"gpt-4-mobile","gpt_4_browsing":"gpt-4-browsing","gpt_4_plugins":"gpt-4-plugins"}}},"openai_api":{"title":"Openai Api","allOf":[{"$ref":"#/components/schemas/OpenaiApiSetting"}],"default":{"enabled":true,"openai_base_url":"https://api.openai.com/v1/","connect_timeout":10,"read_timeout":20,"enabled_models":["gpt_3_5","gpt_4"],"model_code_mapping":{"gpt_3_5":"gpt-3.5-turbo","gpt_4":"gpt-4"}}},"common":{"title":"Common","allOf":[{"$ref":"#/components/schemas/CommonSetting"}],"default":{"sync_conversations_on_startup":true,"sync_conversations_regularly":false,"print_sql":false,"create_initial_admin_user":true,"initial_admin_user_username":"admin","initial_admin_user_password":"password"}},"http":{"title":"Http","allOf":[{"$ref":"#/components/schemas/HttpSetting"}],"default":{"host":"127.0.0.1","port":8000,"cors_allow_origins":["http://localhost","http://127.0.0.1"]}},"data":{"title":"Data","allOf":[{"$ref":"#/components/schemas/DataSetting"}],"default":{"data_dir":"./data","database_url":"sqlite+aiosqlite:///data/database.db","mongodb_url":"mongodb://cws:password@mongo:27017","run_migration":false}},"auth":{"title":"Auth","allOf":[{"$ref":"#/components/schemas/AuthSetting"}],"default":{"jwt_secret":"MODIFY_THIS_TO_RANDOM_SECRET","jwt_lifetime_seconds":86400,"cookie_max_age":86400,"cookie_name":"user_auth","user_secret":"MODIFY_THIS_TO_RANDOM_SECRET"}},"stats":{"title":"Stats","allOf":[{"$ref":"#/components/schemas/StatsSetting"}],"default":{"ask_stats_ttl":7776000,"request_stats_ttl":2592000,"request_stats_filter_keywords":["/status"]}},"log":{"title":"Log","allOf":[{"$ref":"#/components/schemas/LogSetting"}],"default":{"console_log_level":"INFO"}}}},"CredentialsModel":{"title":"CredentialsModel","type":"object","properties":{"openai_web_access_token":{"title":"Openai Web Access Token","type":"string"},"openai_api_key":{"title":"Openai Api Key","type":"string"}}},"CustomOpenaiApiSettings":{"title":"CustomOpenaiApiSettings","type":"object","properties":{"url":{"title":"Url","type":"string"},"key":{"title":"Key","type":"string"}}},"DailyTimeSlot":{"title":"DailyTimeSlot","required":["start_time","end_time"],"type":"object","properties":{"start_time":{"title":"Start Time","type":"string","description":"每天可使用的开始时间","format":"time"},"end_time":{"title":"End Time","type":"string","description":"每天可使用的结束时间","format":"time"}}},"DataSetting":{"title":"DataSetting","type":"object","properties":{"data_dir":{"title":"Data Dir","type":"string","default":"./data"},"database_url":{"title":"Database Url","type":"string","default":"sqlite+aiosqlite:///data/database.db"},"mongodb_url":{"title":"Mongodb Url","type":"string","default":"mongodb://cws:password@mongo:27017"},"run_migration":{"title":"Run Migration","type":"boolean","default":false}}},"HTTPValidationError":{"title":"HTTPValidationError","type":"object","properties":{"detail":{"title":"Detail","type":"array","items":{"$ref":"#/components/schemas/ValidationError"}}}},"HttpSetting":{"title":"HttpSetting","type":"object","properties":{"host":{"title":"Host","type":"string","default":"127.0.0.1"},"port":{"title":"Port","maximum":65535.0,"minimum":1.0,"type":"integer","default":8000},"cors_allow_origins":{"title":"Cors Allow Origins","type":"array","items":{"type":"string"},"default":["http://localhost","http://127.0.0.1"]}}},"LogFilterOptions":{"title":"LogFilterOptions","type":"object","properties":{"max_lines":{"title":"Max Lines","type":"integer","default":100},"exclude_keywords":{"title":"Exclude Keywords","type":"array","items":{"type":"string"}}}},"LogSetting":{"title":"LogSetting","type":"object","properties":{"console_log_level":{"title":"Console Log Level","enum":["INFO","DEBUG","WARNING"],"type":"string","default":"INFO"}}},"OpenaiApiAskLogMeta":{"title":"OpenaiApiAskLogMeta","required":["source","model"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_api"],"type":"string"},"model":{"$ref":"#/components/schemas/OpenaiApiChatModels"}}},"OpenaiApiChatMessage":{"title":"OpenaiApiChatMessage","required":["id","source","role","children"],"type":"object","properties":{"id":{"title":"Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_api"],"type":"string"},"role":{"title":"Role","anyOf":[{"enum":["system","user","assistant","tool"],"type":"string"},{"type":"string"}]},"author_name":{"title":"Author Name","anyOf":[{"enum":["browser"],"type":"string"},{"type":"string"}]},"model":{"title":"Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"parent":{"title":"Parent","type":"string","format":"uuid"},"children":{"title":"Children","type":"array","items":{"type":"string","format":"uuid"}},"content":{"$ref":"#/components/schemas/OpenaiApiChatMessageTextContent"},"metadata":{"title":"Metadata","anyOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadata"},{"$ref":"#/components/schemas/OpenaiApiChatMessageMetadata"}]}}},"OpenaiApiChatMessageMetadata":{"title":"OpenaiApiChatMessageMetadata","required":["source"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_api"],"type":"string"},"usage":{"$ref":"#/components/schemas/OpenaiChatResponseUsage"},"finish_reason":{"title":"Finish Reason","type":"string"}}},"OpenaiApiChatMessageTextContent":{"title":"OpenaiApiChatMessageTextContent","required":["content_type","text"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["text"],"type":"string"},"text":{"title":"Text","type":"string"}}},"OpenaiApiChatModels":{"title":"OpenaiApiChatModels","enum":["gpt_3_5","gpt_4"],"type":"string","description":"An enumeration."},"OpenaiApiConversationHistoryDocument":{"title":"OpenaiApiConversationHistoryDocument","required":["source","title","create_time","update_time","mapping"],"type":"object","properties":{"_id":{"title":" Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_api"],"type":"string"},"title":{"title":"Title","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"},"mapping":{"title":"Mapping","type":"object","additionalProperties":{"$ref":"#/components/schemas/OpenaiApiChatMessage"}},"current_node":{"title":"Current Node","type":"string","format":"uuid"},"current_model":{"title":"Current Model","type":"string"},"metadata":{"title":"Metadata","anyOf":[{"$ref":"#/components/schemas/OpenaiWebConversationHistoryMeta"},{"$ref":"#/components/schemas/OpenaiApiConversationHistoryMeta"}]}},"description":"Document Mapping class.\n\nFields:\n\n- `id` - MongoDB document ObjectID \"_id\" field.\nMapped to the PydanticObjectId class\n\nInherited from:\n\n- Pydantic BaseModel\n- [UpdateMethods](https://roman-right.github.io/beanie/api/interfaces/#aggregatemethods)"},"OpenaiApiConversationHistoryMeta":{"title":"OpenaiApiConversationHistoryMeta","required":["source"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_api"],"type":"string"}}},"OpenaiApiConversationSchema":{"title":"OpenaiApiConversationSchema","required":["source"],"type":"object","properties":{"id":{"title":"Id","type":"integer","default":-1},"source":{"title":"Source","enum":["openai_api"],"type":"string"},"conversation_id":{"title":"Conversation Id","type":"string","format":"uuid"},"title":{"title":"Title","type":"string"},"user_id":{"title":"User Id","type":"integer"},"is_valid":{"title":"Is Valid","type":"boolean","default":true},"current_model":{"title":"Current Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"}}},"OpenaiApiPerModelAskCount":{"title":"OpenaiApiPerModelAskCount","type":"object","additionalProperties":{"type":"integer"},"default":{"gpt_3_5":0,"gpt_4":0}},"OpenaiApiSetting":{"title":"OpenaiApiSetting","type":"object","properties":{"enabled":{"title":"Enabled","type":"boolean","default":true},"openai_base_url":{"title":"Openai Base Url","type":"string","default":"https://api.openai.com/v1/"},"proxy":{"title":"Proxy","type":"string"},"connect_timeout":{"title":"Connect Timeout","minimum":1.0,"type":"integer","default":10},"read_timeout":{"title":"Read Timeout","minimum":1.0,"type":"integer","default":20},"enabled_models":{"type":"array","items":{"$ref":"#/components/schemas/OpenaiApiChatModels"},"default":["gpt_3_5","gpt_4"]},"model_code_mapping":{"title":"Model Code Mapping","type":"object","additionalProperties":{"type":"string"},"default":{"gpt_3_5":"gpt-3.5-turbo","gpt_4":"gpt-4"}}}},"OpenaiApiSourceSettingSchema":{"title":"OpenaiApiSourceSettingSchema","required":["allow_to_use","max_conv_count","total_ask_count","rate_limits","daily_available_time_slots","available_models","per_model_ask_count","allow_custom_openai_api","custom_openai_api_settings"],"type":"object","properties":{"allow_to_use":{"title":"Allow To Use","type":"boolean"},"valid_until":{"title":"Valid Until","type":"string","format":"date-time"},"max_conv_count":{"title":"Max Conv Count","type":"integer"},"total_ask_count":{"title":"Total Ask Count","type":"integer"},"rate_limits":{"title":"Rate Limits","type":"array","items":{"$ref":"#/components/schemas/TimeWindowRateLimit"}},"daily_available_time_slots":{"title":"Daily Available Time Slots","type":"array","items":{"$ref":"#/components/schemas/DailyTimeSlot"}},"available_models":{"type":"array","items":{"$ref":"#/components/schemas/OpenaiApiChatModels"}},"per_model_ask_count":{"$ref":"#/components/schemas/OpenaiApiPerModelAskCount"},"allow_custom_openai_api":{"title":"Allow Custom Openai Api","type":"boolean"},"custom_openai_api_settings":{"$ref":"#/components/schemas/CustomOpenaiApiSettings"}}},"OpenaiChatPlugin":{"title":"OpenaiChatPlugin","type":"object","properties":{"id":{"title":"Id","type":"string"},"namespace":{"title":"Namespace","type":"string"},"manifest":{"$ref":"#/components/schemas/OpenaiChatPluginManifest"},"categories":{"title":"Categories","type":"array","items":{"$ref":"#/components/schemas/OpenaiChatPluginCategory"}},"domain":{"title":"Domain","type":"string"},"status":{"title":"Status","anyOf":[{"enum":["approved"],"type":"string"},{"type":"string"}]},"user_settings":{"title":"User Settings","anyOf":[{"$ref":"#/components/schemas/OpenaiChatPluginUserSettings"},{"type":"object"}]},"oauth_client_id":{"title":"Oauth Client Id","type":"string"}}},"OpenaiChatPluginCategory":{"title":"OpenaiChatPluginCategory","type":"object","properties":{"id":{"title":"Id","type":"string"},"title":{"title":"Title","type":"string"}}},"OpenaiChatPluginManifest":{"title":"OpenaiChatPluginManifest","type":"object","properties":{"api":{"title":"Api","type":"object"},"auth":{"title":"Auth","type":"object"},"logo_url":{"title":"Logo Url","type":"string"},"contact_email":{"title":"Contact Email","type":"string"},"schema_version":{"title":"Schema Version","type":"string"},"name_for_model":{"title":"Name For Model","type":"string"},"name_for_human":{"title":"Name For Human","type":"string"},"description_for_model":{"title":"Description For Model","type":"string"},"description_for_human":{"title":"Description For Human","type":"string"},"legal_info_url":{"title":"Legal Info Url","type":"string"}}},"OpenaiChatPluginUserSettings":{"title":"OpenaiChatPluginUserSettings","type":"object","properties":{"is_authenticated":{"title":"Is Authenticated","type":"boolean"},"is_installed":{"title":"Is Installed","type":"boolean"}}},"OpenaiChatResponseUsage":{"title":"OpenaiChatResponseUsage","type":"object","properties":{"prompt_tokens":{"title":"Prompt Tokens","type":"integer"},"completion_tokens":{"title":"Completion Tokens","type":"integer"}}},"OpenaiWebAskLogMeta":{"title":"OpenaiWebAskLogMeta","required":["source","model"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_web"],"type":"string"},"model":{"$ref":"#/components/schemas/OpenaiWebChatModels"}}},"OpenaiWebChatGPTSetting":{"title":"OpenaiWebChatGPTSetting","type":"object","properties":{"enabled":{"title":"Enabled","type":"boolean","default":true},"is_plus_account":{"title":"Is Plus Account","type":"boolean","default":true},"chatgpt_base_url":{"title":"Chatgpt Base Url","type":"string"},"proxy":{"title":"Proxy","type":"string"},"common_timeout":{"title":"Common Timeout","minimum":1.0,"type":"integer","default":10},"ask_timeout":{"title":"Ask Timeout","minimum":1.0,"type":"integer","default":600},"enabled_models":{"type":"array","items":{"$ref":"#/components/schemas/OpenaiWebChatModels"},"default":["gpt_3_5","gpt_4","gpt_4_browsing","gpt_4_plugins"]},"model_code_mapping":{"title":"Model Code Mapping","type":"object","additionalProperties":{"type":"string"},"default":{"gpt_3_5":"text-davinci-002-render-sha","gpt_3_5_mobile":"text-davinci-002-render-sha-mobile","gpt_4":"gpt-4","gpt_4_mobile":"gpt-4-mobile","gpt_4_browsing":"gpt-4-browsing","gpt_4_plugins":"gpt-4-plugins"}}}},"OpenaiWebChatMessage":{"title":"OpenaiWebChatMessage","required":["id","source","role","children"],"type":"object","properties":{"id":{"title":"Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_web"],"type":"string"},"role":{"title":"Role","anyOf":[{"enum":["system","user","assistant","tool"],"type":"string"},{"type":"string"}]},"author_name":{"title":"Author Name","anyOf":[{"enum":["browser"],"type":"string"},{"type":"string"}]},"model":{"title":"Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"parent":{"title":"Parent","type":"string","format":"uuid"},"children":{"title":"Children","type":"array","items":{"type":"string","format":"uuid"}},"content":{"title":"Content","anyOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessageTextContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageCodeContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageStderrContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageTetherBrowsingDisplayContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageTetherQuoteContent"},{"$ref":"#/components/schemas/OpenaiWebChatMessageSystemErrorContent"}]},"metadata":{"title":"Metadata","anyOf":[{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadata"},{"$ref":"#/components/schemas/OpenaiApiChatMessageMetadata"}]}}},"OpenaiWebChatMessageCodeContent":{"title":"OpenaiWebChatMessageCodeContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["code"],"type":"string"},"language":{"title":"Language","type":"string"},"text":{"title":"Text","type":"string"}}},"OpenaiWebChatMessageMetadata":{"title":"OpenaiWebChatMessageMetadata","required":["source"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_web"],"type":"string"},"finish_details":{"title":"Finish Details","type":"object"},"weight":{"title":"Weight","type":"number"},"end_turn":{"title":"End Turn","type":"boolean"},"message_status":{"title":"Message Status","type":"string"},"recipient":{"title":"Recipient","anyOf":[{"enum":["all","browser"],"type":"string"},{"type":"string"}]},"fallback_content":{"title":"Fallback Content"},"invoked_plugin":{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadataPlugin"},"command":{"title":"Command","anyOf":[{"enum":["search"],"type":"string"},{"type":"string"}]},"args":{"title":"Args","type":"array","items":{"type":"string"}},"status":{"title":"Status","anyOf":[{"enum":["finished"],"type":"string"},{"type":"string"}]},"_cite_metadata":{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadataCite"},"citations":{"title":"Citations","type":"array","items":{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadataCitation"}}}},"OpenaiWebChatMessageMetadataCitation":{"title":"OpenaiWebChatMessageMetadataCitation","type":"object","properties":{"start_ix":{"title":"Start Ix","type":"integer"},"end_ix":{"title":"End Ix","type":"integer"},"metadata":{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadataCiteData"}}},"OpenaiWebChatMessageMetadataCite":{"title":"OpenaiWebChatMessageMetadataCite","type":"object","properties":{"citation_format":{"title":"Citation Format","type":"object"},"metadata_list":{"title":"Metadata List","type":"array","items":{"$ref":"#/components/schemas/OpenaiWebChatMessageMetadataCiteData"}}}},"OpenaiWebChatMessageMetadataCiteData":{"title":"OpenaiWebChatMessageMetadataCiteData","type":"object","properties":{"title":{"title":"Title","type":"string"},"url":{"title":"Url","type":"string"},"text":{"title":"Text","type":"string"}}},"OpenaiWebChatMessageMetadataPlugin":{"title":"OpenaiWebChatMessageMetadataPlugin","type":"object","properties":{"http_response_status":{"title":"Http Response Status","type":"integer"},"namespace":{"title":"Namespace","type":"string"},"plugin_id":{"title":"Plugin Id","type":"string"},"type":{"title":"Type","type":"string"}}},"OpenaiWebChatMessageStderrContent":{"title":"OpenaiWebChatMessageStderrContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["stderr"],"type":"string"},"text":{"title":"Text","type":"string"}}},"OpenaiWebChatMessageSystemErrorContent":{"title":"OpenaiWebChatMessageSystemErrorContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["system_error"],"type":"string"},"name":{"title":"Name","anyOf":[{"enum":["tool_error"],"type":"string"},{"type":"string"}]},"text":{"title":"Text","type":"string"}}},"OpenaiWebChatMessageTetherBrowsingDisplayContent":{"title":"OpenaiWebChatMessageTetherBrowsingDisplayContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["tether_browsing_display"],"type":"string"},"result":{"title":"Result","type":"string"}}},"OpenaiWebChatMessageTetherQuoteContent":{"title":"OpenaiWebChatMessageTetherQuoteContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["tether_quote"],"type":"string"},"url":{"title":"Url","type":"string"},"domain":{"title":"Domain","type":"string"},"text":{"title":"Text","type":"string"},"title":{"title":"Title","type":"string"}}},"OpenaiWebChatMessageTextContent":{"title":"OpenaiWebChatMessageTextContent","required":["content_type"],"type":"object","properties":{"content_type":{"title":"Content Type","enum":["text"],"type":"string"},"parts":{"title":"Parts","type":"array","items":{"type":"string"}}}},"OpenaiWebChatModels":{"title":"OpenaiWebChatModels","enum":["gpt_3_5","gpt_3_5_mobile","gpt_4","gpt_4_mobile","gpt_4_browsing","gpt_4_plugins"],"type":"string","description":"An enumeration."},"OpenaiWebChatStatus":{"title":"OpenaiWebChatStatus","enum":["asking","queueing","idling"],"type":"string","description":"An enumeration."},"OpenaiWebConversationHistoryDocument":{"title":"OpenaiWebConversationHistoryDocument","required":["source","title","create_time","update_time","mapping"],"type":"object","properties":{"_id":{"title":" Id","type":"string","format":"uuid"},"source":{"title":"Source","enum":["openai_web"],"type":"string"},"title":{"title":"Title","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"},"mapping":{"title":"Mapping","type":"object","additionalProperties":{"$ref":"#/components/schemas/OpenaiWebChatMessage"}},"current_node":{"title":"Current Node","type":"string","format":"uuid"},"current_model":{"title":"Current Model","type":"string"},"metadata":{"$ref":"#/components/schemas/OpenaiWebConversationHistoryMeta"}},"description":"Document Mapping class.\n\nFields:\n\n- `id` - MongoDB document ObjectID \"_id\" field.\nMapped to the PydanticObjectId class\n\nInherited from:\n\n- Pydantic BaseModel\n- [UpdateMethods](https://roman-right.github.io/beanie/api/interfaces/#aggregatemethods)"},"OpenaiWebConversationHistoryMeta":{"title":"OpenaiWebConversationHistoryMeta","required":["source"],"type":"object","properties":{"source":{"title":"Source","enum":["openai_web"],"type":"string"},"moderation_results":{"title":"Moderation Results","type":"array","items":{}},"plugin_ids":{"title":"Plugin Ids","type":"array","items":{"type":"string"}}}},"OpenaiWebConversationSchema":{"title":"OpenaiWebConversationSchema","required":["source"],"type":"object","properties":{"id":{"title":"Id","type":"integer","default":-1},"source":{"title":"Source","enum":["openai_web"],"type":"string"},"conversation_id":{"title":"Conversation Id","type":"string","format":"uuid"},"title":{"title":"Title","type":"string"},"user_id":{"title":"User Id","type":"integer"},"is_valid":{"title":"Is Valid","type":"boolean","default":true},"current_model":{"title":"Current Model","type":"string"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"update_time":{"title":"Update Time","type":"string","format":"date-time"}}},"OpenaiWebPerModelAskCount":{"title":"OpenaiWebPerModelAskCount","type":"object","additionalProperties":{"type":"integer"},"default":{"gpt_3_5":0,"gpt_3_5_mobile":0,"gpt_4":0,"gpt_4_mobile":0,"gpt_4_browsing":0,"gpt_4_plugins":0}},"OpenaiWebSourceSettingSchema":{"title":"OpenaiWebSourceSettingSchema","required":["allow_to_use","max_conv_count","total_ask_count","rate_limits","daily_available_time_slots","available_models","per_model_ask_count"],"type":"object","properties":{"allow_to_use":{"title":"Allow To Use","type":"boolean"},"valid_until":{"title":"Valid Until","type":"string","format":"date-time"},"max_conv_count":{"title":"Max Conv Count","type":"integer"},"total_ask_count":{"title":"Total Ask Count","type":"integer"},"rate_limits":{"title":"Rate Limits","type":"array","items":{"$ref":"#/components/schemas/TimeWindowRateLimit"}},"daily_available_time_slots":{"title":"Daily Available Time Slots","type":"array","items":{"$ref":"#/components/schemas/DailyTimeSlot"}},"available_models":{"type":"array","items":{"$ref":"#/components/schemas/OpenaiWebChatModels"}},"per_model_ask_count":{"$ref":"#/components/schemas/OpenaiWebPerModelAskCount"}}},"RequestLogAggregation":{"title":"RequestLogAggregation","required":["_id","count"],"type":"object","properties":{"_id":{"$ref":"#/components/schemas/RequestLogAggregationID"},"count":{"title":"Count","type":"integer"},"user_ids":{"title":"User Ids","type":"array","items":{"type":"integer"}},"avg_elapsed_ms":{"title":"Avg Elapsed Ms","type":"number"}}},"RequestLogAggregationID":{"title":"RequestLogAggregationID","type":"object","properties":{"start_time":{"title":"Start Time","type":"string","format":"date-time"},"route_path":{"title":"Route Path","type":"string"},"method":{"title":"Method","type":"string"}}},"StatsSetting":{"title":"StatsSetting","type":"object","properties":{"ask_stats_ttl":{"title":"Ask Stats Ttl","type":"integer","default":7776000},"request_stats_ttl":{"title":"Request Stats Ttl","type":"integer","default":2592000},"request_stats_filter_keywords":{"title":"Request Stats Filter Keywords","type":"array","items":{"type":"string"},"default":["/status"]}}},"SystemInfo":{"title":"SystemInfo","required":["startup_time","total_user_count","total_conversation_count","valid_conversation_count"],"type":"object","properties":{"startup_time":{"title":"Startup Time","type":"number"},"total_user_count":{"title":"Total User Count","type":"integer"},"total_conversation_count":{"title":"Total Conversation Count","type":"integer"},"valid_conversation_count":{"title":"Valid Conversation Count","type":"integer"}}},"TimeWindowRateLimit":{"title":"TimeWindowRateLimit","required":["window_seconds","max_requests"],"type":"object","properties":{"window_seconds":{"title":"Window Seconds","type":"integer","description":"时间窗口大小，单位为秒"},"max_requests":{"title":"Max Requests","type":"integer","description":"在给定时间窗口内最多的请求次数"}}},"UserCreate":{"title":"UserCreate","required":["email","password","username","nickname"],"type":"object","properties":{"email":{"title":"Email","type":"string","format":"email"},"password":{"title":"Password","type":"string"},"is_active":{"title":"Is Active","type":"boolean","default":true},"is_superuser":{"title":"Is Superuser","type":"boolean","default":false},"is_verified":{"title":"Is Verified","type":"boolean","default":false},"username":{"title":"Username","type":"string"},"nickname":{"title":"Nickname","type":"string"},"avatar":{"title":"Avatar","type":"string"},"remark":{"title":"Remark","type":"string"}}},"UserRead":{"title":"UserRead","required":["id","email","is_active","is_superuser","is_verified","username","nickname","create_time","setting"],"type":"object","properties":{"id":{"title":"Id","type":"integer"},"email":{"title":"Email","type":"string","format":"email"},"is_active":{"title":"Is Active","type":"boolean"},"is_superuser":{"title":"Is Superuser","type":"boolean"},"is_verified":{"title":"Is Verified","type":"boolean"},"username":{"title":"Username","type":"string"},"nickname":{"title":"Nickname","type":"string"},"last_active_time":{"title":"Last Active Time","type":"string","format":"date-time"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"avatar":{"title":"Avatar","type":"string"},"setting":{"$ref":"#/components/schemas/UserSettingSchema"}},"description":"Base User model."},"UserReadAdmin":{"title":"UserReadAdmin","required":["id","email","is_active","is_superuser","is_verified","username","nickname","create_time","setting"],"type":"object","properties":{"id":{"title":"Id","type":"integer"},"email":{"title":"Email","type":"string","format":"email"},"is_active":{"title":"Is Active","type":"boolean"},"is_superuser":{"title":"Is Superuser","type":"boolean"},"is_verified":{"title":"Is Verified","type":"boolean"},"username":{"title":"Username","type":"string"},"nickname":{"title":"Nickname","type":"string"},"last_active_time":{"title":"Last Active Time","type":"string","format":"date-time"},"create_time":{"title":"Create Time","type":"string","format":"date-time"},"avatar":{"title":"Avatar","type":"string"},"setting":{"$ref":"#/components/schemas/UserSettingSchema"},"remark":{"title":"Remark","type":"string"}},"description":"Base User model."},"UserSettingSchema":{"title":"UserSettingSchema","required":["credits","openai_web_chat_status","openai_web","openai_api"],"type":"object","properties":{"id":{"title":"Id","type":"integer"},"user_id":{"title":"User Id","type":"integer"},"credits":{"title":"Credits","type":"number"},"openai_web_chat_status":{"$ref":"#/components/schemas/OpenaiWebChatStatus"},"openai_web":{"$ref":"#/components/schemas/OpenaiWebSourceSettingSchema"},"openai_api":{"$ref":"#/components/schemas/OpenaiApiSourceSettingSchema"}}},"UserUpdate":{"title":"UserUpdate","type":"object","properties":{"password":{"title":"Password","type":"string"},"email":{"title":"Email","type":"string"},"is_active":{"title":"Is Active","type":"boolean"},"is_superuser":{"title":"Is Superuser","type":"boolean"},"is_verified":{"title":"Is Verified","type":"boolean"},"nickname":{"title":"Nickname","type":"string"},"avatar":{"title":"Avatar","type":"string"}}},"UserUpdateAdmin":{"title":"UserUpdateAdmin","type":"object","properties":{"password":{"title":"Password","type":"string"},"email":{"title":"Email","type":"string"},"is_active":{"title":"Is Active","type":"boolean"},"is_superuser":{"title":"Is Superuser","type":"boolean"},"is_verified":{"title":"Is Verified","type":"boolean"},"nickname":{"title":"Nickname","type":"string"},"avatar":{"title":"Avatar","type":"string"},"username":{"title":"Username","type":"string"},"remark":{"title":"Remark","type":"string"}}},"ValidationError":{"title":"ValidationError","required":["loc","msg","type"],"type":"object","properties":{"loc":{"title":"Location","type":"array","items":{"anyOf":[{"type":"string"},{"type":"integer"}]}},"msg":{"title":"Message","type":"string"},"type":{"title":"Error Type","type":"string"}}}},"securitySchemes":{"APIKeyCookie":{"type":"apiKey","in":"cookie","name":"user_auth"}}}}