{
  "openapi": "3.1.0",
  "info": { "title": "FastAPI", "version": "0.1.0" },
  "paths": {
    "/auth/login": {
      "post": {
        "summary": "Auth:Jwt.Login",
        "operationId": "auth_jwt_login_auth_login_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": { "$ref": "#/components/schemas/Body_auth_jwt_login_auth_login_post" }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "summary": "Auth:Jwt.Logout",
        "operationId": "auth_jwt_logout_auth_logout_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/auth/register": {
      "post": {
        "tags": ["auth"],
        "summary": "Register",
        "description": "注册时不能指定setting，使用默认setting",
        "operationId": "register_auth_register_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserCreate" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/user": {
      "get": {
        "tags": ["user"],
        "summary": "Get All Users",
        "operationId": "get_all_users_user_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/user/me": {
      "get": {
        "tags": ["user"],
        "summary": "Get Me",
        "operationId": "get_me_user_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "patch": {
        "tags": ["user"],
        "summary": "Update Me",
        "operationId": "update_me_user_me_patch",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserUpdate" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/user/{user_id}": {
      "get": {
        "tags": ["user"],
        "summary": "Admin Get User",
        "operationId": "admin_get_user_user__user_id__get",
        "parameters": [
          { "required": true, "schema": { "type": "integer", "title": "User Id" }, "name": "user_id", "in": "path" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "delete": {
        "tags": ["user"],
        "summary": "Admin Delete User",
        "operationId": "admin_delete_user_user__user_id__delete",
        "parameters": [
          { "required": true, "schema": { "type": "integer", "title": "User Id" }, "name": "user_id", "in": "path" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "patch": {
        "tags": ["user"],
        "summary": "Admin Update User",
        "operationId": "admin_update_user_user__user_id__patch",
        "parameters": [
          { "required": true, "schema": { "type": "integer", "title": "User Id" }, "name": "user_id", "in": "path" }
        ],
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserUpdateAdmin" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/user/{user_id}/setting": {
      "patch": {
        "tags": ["user"],
        "summary": "Admin Update User Setting",
        "operationId": "admin_update_user_setting_user__user_id__setting_patch",
        "parameters": [
          { "required": true, "schema": { "type": "integer", "title": "User Id" }, "name": "user_id", "in": "path" }
        ],
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/UserSettingSchema" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get My Conversations",
        "description": "返回自己的有效会话",
        "operationId": "get_my_conversations_conv_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "delete": {
        "tags": ["conversation"],
        "summary": "Delete All Conversation",
        "operationId": "delete_all_conversation_conv_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/all": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get All Conversations",
        "operationId": "get_all_conversations_conv_all_get",
        "parameters": [
          {
            "required": false,
            "schema": { "type": "boolean", "title": "Valid Only", "default": false },
            "name": "valid_only",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get Conversation History",
        "operationId": "get_conversation_history_conv__conversation_id__get",
        "parameters": [
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "delete": {
        "tags": ["conversation"],
        "summary": "Delete Conversation",
        "description": "软删除：标记为 invalid 并且从 chatgpt 账号中删除会话，但不会删除 mongodb 中的历史记录",
        "operationId": "delete_conversation_conv__conversation_id__delete",
        "parameters": [
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "patch": {
        "tags": ["conversation"],
        "summary": "Update Conversation Title",
        "operationId": "update_conversation_title_conv__conversation_id__patch",
        "parameters": [
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          },
          { "required": true, "schema": { "type": "string", "title": "Title" }, "name": "title", "in": "query" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}/cache": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get Conversation History From Cache",
        "operationId": "get_conversation_history_from_cache_conv__conversation_id__cache_get",
        "parameters": [
          { "required": true, "schema": { "title": "Conversation Id" }, "name": "conversation_id", "in": "path" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}/vanish": {
      "delete": {
        "tags": ["conversation"],
        "summary": "Vanish Conversation",
        "description": "硬删除：删除数据库和账号中的对话和历史记录",
        "operationId": "vanish_conversation_conv__conversation_id__vanish_delete",
        "parameters": [
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}/assign/{username}": {
      "patch": {
        "tags": ["conversation"],
        "summary": "Assign Conversation",
        "operationId": "assign_conversation_conv__conversation_id__assign__username__patch",
        "parameters": [
          { "required": true, "schema": { "type": "string", "title": "Username" }, "name": "username", "in": "path" },
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}/gen_title": {
      "patch": {
        "tags": ["conversation"],
        "summary": "Generate Conversation Title",
        "operationId": "generate_conversation_title_conv__conversation_id__gen_title_patch",
        "parameters": [
          {
            "required": true,
            "schema": {
              "anyOf": [{ "type": "string" }, { "type": "string", "format": "uuid" }],
              "title": "Conversation Id"
            },
            "name": "conversation_id",
            "in": "path"
          },
          {
            "required": true,
            "schema": { "type": "string", "title": "Message Id" },
            "name": "message_id",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/conv/{conversation_id}/interpreter": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get Conversation Interpreter Info",
        "operationId": "get_conversation_interpreter_info_conv__conversation_id__interpreter_get",
        "parameters": [
          {
            "required": true,
            "schema": { "type": "string", "title": "Conversation Id" },
            "name": "conversation_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        }
      }
    },
    "/conv/{conversation_id}/interpreter/download-url": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get Conversation Interpreter Download Url",
        "operationId": "get_conversation_interpreter_download_url_conv__conversation_id__interpreter_download_url_get",
        "parameters": [
          {
            "required": true,
            "schema": { "type": "string", "title": "Conversation Id" },
            "name": "conversation_id",
            "in": "path"
          },
          {
            "required": true,
            "schema": { "type": "string", "title": "Message Id" },
            "name": "message_id",
            "in": "query"
          },
          {
            "required": true,
            "schema": { "type": "string", "title": "Sandbox Path" },
            "name": "sandbox_path",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        }
      }
    },
    "/chat/openai-plugins/all": {
      "get": {
        "tags": ["chat"],
        "summary": "Get All Openai Web Chat Plugins",
        "operationId": "get_all_openai_web_chat_plugins_chat_openai_plugins_all_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/chat/openai-plugins/installed": {
      "get": {
        "tags": ["chat"],
        "summary": "Get Installed Openai Web Chat Plugins",
        "operationId": "get_installed_openai_web_chat_plugins_chat_openai_plugins_installed_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/chat/openai-plugin/{plugin_id}": {
      "get": {
        "tags": ["chat"],
        "summary": "Get Openai Web Plugin",
        "operationId": "get_openai_web_plugin_chat_openai_plugin__plugin_id__get",
        "parameters": [
          { "required": true, "schema": { "type": "string", "title": "Plugin Id" }, "name": "plugin_id", "in": "path" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/chat/openai-plugin/{plugin_id}/user-settings": {
      "patch": {
        "tags": ["chat"],
        "summary": "Update Chat Plugin User Settings",
        "operationId": "update_chat_plugin_user_settings_chat_openai_plugin__plugin_id__user_settings_patch",
        "parameters": [
          { "required": true, "schema": { "type": "string", "title": "Plugin Id" }, "name": "plugin_id", "in": "path" }
        ],
        "requestBody": {
          "content": {
            "application/json": { "schema": { "$ref": "#/components/schemas/OpenaiChatPluginUserSettings" } }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/chat/__schema_types": {
      "get": {
        "tags": ["chat"],
        "summary": " Predict Schema Types",
        "description": "只用来让 openapi 自动生成 schema，并不实际调用",
        "operationId": "_predict_schema_types_chat___schema_types_get",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/AskRequest" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        }
      }
    },
    "/system/info": {
      "get": {
        "tags": ["system"],
        "summary": "Get System Info",
        "operationId": "get_system_info_system_info_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/stats/request": {
      "get": {
        "tags": ["system"],
        "summary": "Get Request Statistics",
        "operationId": "get_request_statistics_system_stats_request_get",
        "parameters": [
          {
            "required": false,
            "schema": { "type": "integer", "title": "Granularity", "default": 1800 },
            "name": "granularity",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/stats/ask": {
      "get": {
        "tags": ["system"],
        "summary": "Get Ask Statistics",
        "operationId": "get_ask_statistics_system_stats_ask_get",
        "parameters": [
          {
            "required": false,
            "schema": { "type": "integer", "title": "Granularity", "default": 1800 },
            "name": "granularity",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/logs/server": {
      "post": {
        "tags": ["system"],
        "summary": "Get Server Logs",
        "operationId": "get_server_logs_system_logs_server_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "allOf": [{ "$ref": "#/components/schemas/LogFilterOptions" }],
                "title": "Options",
                "default": { "max_lines": 100 }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/config": {
      "get": {
        "tags": ["system"],
        "summary": "Get Config",
        "operationId": "get_config_system_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "put": {
        "tags": ["system"],
        "summary": "Update Config",
        "operationId": "update_config_system_config_put",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/ConfigModel" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/credentials": {
      "get": {
        "tags": ["system"],
        "summary": "Get Credentials",
        "operationId": "get_credentials_system_credentials_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      },
      "put": {
        "tags": ["system"],
        "summary": "Update Credentials",
        "operationId": "update_credentials_system_credentials_put",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/CredentialsModel" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/system/action/sync-openai-web-conv": {
      "post": {
        "tags": ["system"],
        "summary": "Sync Openai Web Conversations",
        "operationId": "sync_openai_web_conversations_system_action_sync_openai_web_conv_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/status/common": {
      "get": {
        "tags": ["status"],
        "summary": "Get Server Status",
        "description": "普通用户获取服务器状态",
        "operationId": "get_server_status_status_common_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/files/{file_id}/download-url": {
      "get": {
        "tags": ["conversation"],
        "summary": "Get File Download Url",
        "description": "file_id: OpenAI 分配的 id，以 file- 开头",
        "operationId": "get_file_download_url_files__file_id__download_url_get",
        "parameters": [
          { "required": true, "schema": { "type": "string", "title": "File Id" }, "name": "file_id", "in": "path" }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        }
      }
    },
    "/files/local/upload": {
      "post": {
        "tags": ["files"],
        "summary": "Upload File To Local",
        "description": "上传文件到服务器。文件将被保存在服务器上，返回文件信息。\n仅当需要在服务器留存上传的文件时才使用.",
        "operationId": "upload_file_to_local_files_local_upload_post",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": { "$ref": "#/components/schemas/Body_upload_file_to_local_files_local_upload_post" }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/files/local/download/{file_id}": {
      "get": {
        "tags": ["files"],
        "summary": "Download File From Local",
        "operationId": "download_file_from_local_files_local_download__file_id__get",
        "parameters": [
          {
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "File Id" },
            "name": "file_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/files/openai-web/upload-start": {
      "post": {
        "tags": ["files"],
        "summary": "Start Upload To Openai",
        "description": "要上传文件到 OpenAI Web，前端需要先调用此接口.\n1. 若最终上传方法是前端直接上传 (Browser -> Azure Blob)，则获取上传地址并记录文件信息，响应中 upload_file_info 不为空\n2. 否则的话就是服务端中转上传（Browser -> Local -> Azure Blob，此时响应中 upload_file_info 为空，前端应当:\n    a. 先调用 upload_file_to_local 接口上传文件到服务器，拿到文件的 uuid\n    b. 再调用 upload_local_file_to_openai_web 接口，通知服务器上传文件到 OpenAI Web",
        "operationId": "start_upload_to_openai_files_openai_web_upload_start_post",
        "requestBody": {
          "content": { "application/json": { "schema": { "$ref": "#/components/schemas/OpenaiChatFileUploadInfo" } } },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/files/openai-web/upload-complete/{file_id}": {
      "post": {
        "tags": ["files"],
        "summary": "Complete Upload To Openai",
        "operationId": "complete_upload_to_openai_files_openai_web_upload_complete__file_id__post",
        "parameters": [
          {
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "File Id" },
            "name": "file_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    },
    "/files/local/upload-to-openai-web/{file_id}": {
      "post": {
        "tags": ["files"],
        "summary": "Upload Local File To Openai Web",
        "description": "将服务器上已有的文件上传到 OpenAI Web（Azure blob）",
        "operationId": "upload_local_file_to_openai_web_files_local_upload_to_openai_web__file_id__post",
        "parameters": [
          {
            "required": true,
            "schema": { "type": "string", "format": "uuid", "title": "File Id" },
            "name": "file_id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": { "application/json": { "schema": { "type": "string" } } }
          },
          "422": {
            "description": "Validation Error",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/HTTPValidationError" } } }
          }
        },
        "security": [{ "APIKeyCookie": [] }]
      }
    }
  },
  "components": {
    "schemas": {
      "AskLogAggregation": {
        "properties": {
          "_id": { "$ref": "#/components/schemas/AskLogAggregationID" },
          "count": { "type": "integer", "title": "Count" },
          "user_ids": { "items": { "type": "integer" }, "type": "array", "title": "User Ids" },
          "total_queueing_time": { "type": "number", "title": "Total Queueing Time" },
          "total_ask_time": { "type": "number", "title": "Total Ask Time" }
        },
        "type": "object",
        "required": ["count"],
        "title": "AskLogAggregation"
      },
      "AskLogAggregationID": {
        "properties": {
          "start_time": { "type": "string", "format": "date-time", "title": "Start Time" },
          "meta": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebAskLogMeta" },
              { "$ref": "#/components/schemas/OpenaiApiAskLogMeta" }
            ],
            "title": "Meta"
          }
        },
        "type": "object",
        "required": ["start_time"],
        "title": "AskLogAggregationID"
      },
      "AskRequest": {
        "properties": {
          "source": { "$ref": "#/components/schemas/ChatSourceTypes" },
          "model": { "type": "string", "title": "Model" },
          "new_conversation": { "type": "boolean", "title": "New Conversation" },
          "new_title": { "type": "string", "title": "New Title" },
          "conversation_id": { "type": "string", "format": "uuid", "title": "Conversation Id" },
          "parent": { "type": "string", "format": "uuid", "title": "Parent" },
          "api_context_message_count": {
            "type": "integer",
            "minimum": -1.0,
            "title": "Api Context Message Count",
            "default": -1
          },
          "text_content": { "type": "string", "title": "Text Content" },
          "openai_web_plugin_ids": { "items": { "type": "string" }, "type": "array", "title": "Openai Web Plugin Ids" },
          "openai_web_attachments": {
            "items": { "$ref": "#/components/schemas/OpenaiWebAskAttachment" },
            "type": "array",
            "title": "Openai Web Attachments"
          },
          "openai_web_multimodal_image_parts": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextContentImagePart" },
            "type": "array",
            "title": "Openai Web Multimodal Image Parts"
          }
        },
        "type": "object",
        "required": ["source", "model", "new_conversation", "text_content"],
        "title": "AskRequest"
      },
      "AskResponse": {
        "properties": {
          "type": { "$ref": "#/components/schemas/AskResponseType" },
          "tip": { "type": "string", "title": "Tip" },
          "conversation_id": { "type": "string", "format": "uuid", "title": "Conversation Id" },
          "message": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebChatMessage" },
              { "$ref": "#/components/schemas/OpenaiApiChatMessage" }
            ],
            "title": "Message"
          },
          "error_detail": { "type": "string", "title": "Error Detail" }
        },
        "type": "object",
        "required": ["type"],
        "title": "AskResponse"
      },
      "AskResponseType": {
        "type": "string",
        "enum": ["waiting", "queueing", "message", "error"],
        "title": "AskResponseType",
        "description": "An enumeration."
      },
      "AuthSetting": {
        "properties": {
          "jwt_secret": { "type": "string", "title": "Jwt Secret", "default": "MODIFY_THIS_TO_RANDOM_SECURE_STRING" },
          "jwt_lifetime_seconds": {
            "type": "integer",
            "minimum": 1.0,
            "title": "Jwt Lifetime Seconds",
            "default": 259200
          },
          "cookie_max_age": { "type": "integer", "minimum": 1.0, "title": "Cookie Max Age", "default": 259200 },
          "user_secret": {
            "type": "string",
            "title": "User Secret",
            "default": "MODIFY_THIS_TO_ANOTHER_RANDOM_SECURE_STRING"
          }
        },
        "type": "object",
        "title": "AuthSetting"
      },
      "BaseChatMessage": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "source": { "type": "string", "enum": ["openai_web", "openai_api"], "title": "Source" },
          "role": {
            "anyOf": [{ "type": "string", "enum": ["system", "user", "assistant", "tool"] }, { "type": "string" }],
            "title": "Role"
          },
          "author_name": {
            "anyOf": [{ "type": "string", "enum": ["browser", "python"] }, { "type": "string" }],
            "title": "Author Name"
          },
          "model": { "type": "string", "title": "Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "parent": { "type": "string", "format": "uuid", "title": "Parent" },
          "children": { "items": { "type": "string", "format": "uuid" }, "type": "array", "title": "Children" },
          "content": {
            "anyOf": [
              {
                "oneOf": [
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageTextContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageCodeContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageExecutionOutputContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageStderrContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageTetherBrowsingDisplayContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageTetherQuoteContent" },
                  { "$ref": "#/components/schemas/OpenaiWebChatMessageSystemErrorContent" }
                ]
              },
              { "$ref": "#/components/schemas/OpenaiApiChatMessageTextContent" }
            ],
            "title": "Content"
          },
          "metadata": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadata" },
              { "$ref": "#/components/schemas/OpenaiApiChatMessageMetadata" }
            ],
            "title": "Metadata"
          }
        },
        "type": "object",
        "required": ["id", "source", "role", "children"],
        "title": "BaseChatMessage"
      },
      "BaseConversationHistory": {
        "properties": {
          "_id": { "type": "string", "format": "uuid", "title": " Id" },
          "source": { "type": "string", "enum": ["openai_web", "openai_api"], "title": "Source" },
          "title": { "type": "string", "title": "Title" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" },
          "mapping": {
            "additionalProperties": { "$ref": "#/components/schemas/BaseChatMessage" },
            "type": "object",
            "title": "Mapping"
          },
          "current_node": { "type": "string", "format": "uuid", "title": "Current Node" },
          "current_model": { "type": "string", "title": "Current Model" },
          "metadata": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebConversationHistoryMeta" },
              { "$ref": "#/components/schemas/OpenaiApiConversationHistoryMeta" }
            ],
            "title": "Metadata"
          }
        },
        "type": "object",
        "required": ["source", "title", "create_time", "update_time", "mapping"],
        "title": "BaseConversationHistory"
      },
      "BaseConversationSchema": {
        "properties": {
          "id": { "type": "integer", "title": "Id", "default": -1 },
          "source": { "$ref": "#/components/schemas/ChatSourceTypes" },
          "conversation_id": { "type": "string", "format": "uuid", "title": "Conversation Id" },
          "title": { "type": "string", "title": "Title" },
          "user_id": { "type": "integer", "title": "User Id" },
          "is_valid": { "type": "boolean", "title": "Is Valid", "default": true },
          "current_model": { "type": "string", "title": "Current Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" }
        },
        "type": "object",
        "required": ["source"],
        "title": "BaseConversationSchema"
      },
      "Body_auth_jwt_login_auth_login_post": {
        "properties": {
          "grant_type": { "type": "string", "pattern": "password", "title": "Grant Type" },
          "username": { "type": "string", "title": "Username" },
          "password": { "type": "string", "title": "Password" },
          "scope": { "type": "string", "title": "Scope", "default": "" },
          "client_id": { "type": "string", "title": "Client Id" },
          "client_secret": { "type": "string", "title": "Client Secret" }
        },
        "type": "object",
        "required": ["username", "password"],
        "title": "Body_auth_jwt_login_auth_login_post"
      },
      "Body_upload_file_to_local_files_local_upload_post": {
        "properties": { "file": { "type": "string", "format": "binary", "title": "File" } },
        "type": "object",
        "required": ["file"],
        "title": "Body_upload_file_to_local_files_local_upload_post"
      },
      "ChatSourceTypes": {
        "type": "string",
        "enum": ["openai_web", "openai_api"],
        "title": "ChatSourceTypes",
        "description": "An enumeration."
      },
      "CommonSetting": {
        "properties": {
          "print_sql": { "type": "boolean", "title": "Print Sql", "default": false },
          "create_initial_admin_user": { "type": "boolean", "title": "Create Initial Admin User", "default": true },
          "initial_admin_user_username": {
            "type": "string",
            "title": "Initial Admin User Username",
            "default": "admin"
          },
          "initial_admin_user_password": {
            "type": "string",
            "title": "Initial Admin User Password",
            "default": "password"
          }
        },
        "type": "object",
        "title": "CommonSetting"
      },
      "CommonStatusSchema": {
        "properties": {
          "active_user_in_5m": { "type": "integer", "title": "Active User In 5M" },
          "active_user_in_1h": { "type": "integer", "title": "Active User In 1H" },
          "active_user_in_1d": { "type": "integer", "title": "Active User In 1D" },
          "is_chatbot_busy": { "type": "boolean", "title": "Is Chatbot Busy" },
          "chatbot_waiting_count": { "type": "integer", "title": "Chatbot Waiting Count" },
          "gpt4_count_in_3_hours": { "type": "integer", "title": "Gpt4 Count In 3 Hours" }
        },
        "type": "object",
        "title": "CommonStatusSchema"
      },
      "ConfigModel": {
        "properties": {
          "openai_web": {
            "allOf": [{ "$ref": "#/components/schemas/OpenaiWebChatGPTSetting" }],
            "title": "Openai Web",
            "default": {
              "enabled": true,
              "is_plus_account": true,
              "common_timeout": 20,
              "ask_timeout": 600,
              "sync_conversations_on_startup": true,
              "sync_conversations_schedule": false,
              "sync_conversations_schedule_interval_hours": 12,
              "enabled_models": ["gpt_3_5", "gpt_4", "gpt_4_code_interpreter", "gpt_4_plugins", "gpt_4_browsing"],
              "model_code_mapping": {
                "gpt_3_5": "text-davinci-002-render-sha",
                "gpt_3_5_mobile": "text-davinci-002-render-sha-mobile",
                "gpt_4": "gpt-4",
                "gpt_4_mobile": "gpt-4-mobile",
                "gpt_4_browsing": "gpt-4-browsing",
                "gpt_4_plugins": "gpt-4-plugins",
                "gpt_4_code_interpreter": "gpt-4-code-interpreter",
                "gpt_4_dalle": "gpt-4-dalle"
              },
              "file_upload_strategy": "browser_upload_only",
              "enable_uploading_attachments": true,
              "enable_uploading_multimodal_images": true
            }
          },
          "openai_api": {
            "allOf": [{ "$ref": "#/components/schemas/OpenaiApiSetting" }],
            "title": "Openai Api",
            "default": {
              "enabled": true,
              "openai_base_url": "https://api.openai.com/v1/",
              "connect_timeout": 10,
              "read_timeout": 20,
              "enabled_models": ["gpt_3_5", "gpt_4"],
              "model_code_mapping": { "gpt_3_5": "gpt-3.5-turbo", "gpt_4": "gpt-4" }
            }
          },
          "common": {
            "allOf": [{ "$ref": "#/components/schemas/CommonSetting" }],
            "title": "Common",
            "default": {
              "print_sql": false,
              "create_initial_admin_user": true,
              "initial_admin_user_username": "admin",
              "initial_admin_user_password": "password"
            }
          },
          "http": {
            "allOf": [{ "$ref": "#/components/schemas/HttpSetting" }],
            "title": "Http",
            "default": {
              "host": "127.0.0.1",
              "port": 8000,
              "cors_allow_origins": [
                "http://localhost:8000",
                "http://localhost:5173",
                "http://127.0.0.1:8000",
                "http://127.0.0.1:5173"
              ]
            }
          },
          "data": {
            "allOf": [{ "$ref": "#/components/schemas/DataSetting" }],
            "title": "Data",
            "default": {
              "data_dir": "./data",
              "database_url": "sqlite+aiosqlite:///data/database.db",
              "mongodb_url": "mongodb://cws:password@mongo:27017",
              "mongodb_db_name": "cws",
              "run_migration": false,
              "max_file_upload_size": 104857600
            }
          },
          "auth": {
            "allOf": [{ "$ref": "#/components/schemas/AuthSetting" }],
            "title": "Auth",
            "default": {
              "jwt_secret": "MODIFY_THIS_TO_RANDOM_SECURE_STRING",
              "jwt_lifetime_seconds": 259200,
              "cookie_max_age": 259200,
              "user_secret": "MODIFY_THIS_TO_ANOTHER_RANDOM_SECURE_STRING"
            }
          },
          "stats": {
            "allOf": [{ "$ref": "#/components/schemas/StatsSetting" }],
            "title": "Stats",
            "default": {
              "ask_stats_ttl": 7776000,
              "request_stats_ttl": 2592000,
              "request_stats_filter_keywords": ["/status"]
            }
          },
          "log": {
            "allOf": [{ "$ref": "#/components/schemas/LogSetting" }],
            "title": "Log",
            "default": { "console_log_level": "INFO" }
          }
        },
        "type": "object",
        "title": "ConfigModel"
      },
      "CredentialsModel": {
        "properties": {
          "openai_web_access_token": { "type": "string", "title": "Openai Web Access Token" },
          "openai_api_key": { "type": "string", "title": "Openai Api Key" }
        },
        "type": "object",
        "title": "CredentialsModel"
      },
      "CustomOpenaiApiSettings": {
        "properties": { "url": { "type": "string", "title": "Url" }, "key": { "type": "string", "title": "Key" } },
        "type": "object",
        "title": "CustomOpenaiApiSettings"
      },
      "DailyTimeSlot": {
        "properties": {
          "start_time": {
            "type": "string",
            "format": "time",
            "title": "Start Time",
            "description": "每天可使用的开始时间"
          },
          "end_time": { "type": "string", "format": "time", "title": "End Time", "description": "每天可使用的结束时间" }
        },
        "type": "object",
        "required": ["start_time", "end_time"],
        "title": "DailyTimeSlot"
      },
      "DataSetting": {
        "properties": {
          "data_dir": { "type": "string", "title": "Data Dir", "default": "./data" },
          "database_url": {
            "type": "string",
            "title": "Database Url",
            "default": "sqlite+aiosqlite:///data/database.db"
          },
          "mongodb_url": { "type": "string", "title": "Mongodb Url", "default": "mongodb://cws:password@mongo:27017" },
          "mongodb_db_name": { "type": "string", "title": "Mongodb Db Name", "default": "cws" },
          "run_migration": { "type": "boolean", "title": "Run Migration", "default": false },
          "max_file_upload_size": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Max File Upload Size",
            "default": 104857600
          }
        },
        "type": "object",
        "title": "DataSetting"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": { "items": { "$ref": "#/components/schemas/ValidationError" }, "type": "array", "title": "Detail" }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HttpSetting": {
        "properties": {
          "host": { "type": "string", "title": "Host", "default": "127.0.0.1" },
          "port": { "type": "integer", "maximum": 65535.0, "minimum": 1.0, "title": "Port", "default": 8000 },
          "cors_allow_origins": {
            "items": { "type": "string" },
            "type": "array",
            "title": "Cors Allow Origins",
            "default": [
              "http://localhost:8000",
              "http://localhost:5173",
              "http://127.0.0.1:8000",
              "http://127.0.0.1:5173"
            ]
          }
        },
        "type": "object",
        "title": "HttpSetting"
      },
      "LogFilterOptions": {
        "properties": {
          "max_lines": { "type": "integer", "title": "Max Lines", "default": 100 },
          "exclude_keywords": { "items": { "type": "string" }, "type": "array", "title": "Exclude Keywords" }
        },
        "type": "object",
        "title": "LogFilterOptions"
      },
      "LogSetting": {
        "properties": {
          "console_log_level": {
            "type": "string",
            "enum": ["INFO", "DEBUG", "WARNING"],
            "title": "Console Log Level",
            "default": "INFO"
          }
        },
        "type": "object",
        "title": "LogSetting"
      },
      "OpenaiApiAskLogMeta": {
        "properties": {
          "source": { "type": "string", "enum": ["openai_api"], "title": "Source" },
          "model": { "$ref": "#/components/schemas/OpenaiApiChatModels" }
        },
        "type": "object",
        "required": ["source", "model"],
        "title": "OpenaiApiAskLogMeta"
      },
      "OpenaiApiChatMessage": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "source": { "type": "string", "enum": ["openai_api"], "title": "Source" },
          "role": {
            "anyOf": [{ "type": "string", "enum": ["system", "user", "assistant", "tool"] }, { "type": "string" }],
            "title": "Role"
          },
          "author_name": {
            "anyOf": [{ "type": "string", "enum": ["browser", "python"] }, { "type": "string" }],
            "title": "Author Name"
          },
          "model": { "type": "string", "title": "Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "parent": { "type": "string", "format": "uuid", "title": "Parent" },
          "children": { "items": { "type": "string", "format": "uuid" }, "type": "array", "title": "Children" },
          "content": { "$ref": "#/components/schemas/OpenaiApiChatMessageTextContent" },
          "metadata": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadata" },
              { "$ref": "#/components/schemas/OpenaiApiChatMessageMetadata" }
            ],
            "title": "Metadata"
          }
        },
        "type": "object",
        "required": ["id", "source", "role", "children"],
        "title": "OpenaiApiChatMessage"
      },
      "OpenaiApiChatMessageMetadata": {
        "properties": {
          "source": { "type": "string", "enum": ["openai_api"], "title": "Source" },
          "usage": { "$ref": "#/components/schemas/OpenaiChatResponseUsage" },
          "finish_reason": { "type": "string", "title": "Finish Reason" }
        },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiApiChatMessageMetadata"
      },
      "OpenaiApiChatMessageTextContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["text"], "title": "Content Type" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "required": ["content_type", "text"],
        "title": "OpenaiApiChatMessageTextContent"
      },
      "OpenaiApiChatModels": {
        "type": "string",
        "enum": ["gpt_3_5", "gpt_4"],
        "title": "OpenaiApiChatModels",
        "description": "An enumeration."
      },
      "OpenaiApiConversationHistoryDocument": {
        "properties": {
          "_id": { "type": "string", "format": "uuid", "title": " Id" },
          "source": { "type": "string", "enum": ["openai_api"], "title": "Source" },
          "title": { "type": "string", "title": "Title" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" },
          "mapping": {
            "additionalProperties": { "$ref": "#/components/schemas/OpenaiApiChatMessage" },
            "type": "object",
            "title": "Mapping"
          },
          "current_node": { "type": "string", "format": "uuid", "title": "Current Node" },
          "current_model": { "type": "string", "title": "Current Model" },
          "metadata": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebConversationHistoryMeta" },
              { "$ref": "#/components/schemas/OpenaiApiConversationHistoryMeta" }
            ],
            "title": "Metadata"
          }
        },
        "type": "object",
        "required": ["source", "title", "create_time", "update_time", "mapping"],
        "title": "OpenaiApiConversationHistoryDocument",
        "description": "Document Mapping class.\n\nFields:\n\n- `id` - MongoDB document ObjectID \"_id\" field.\nMapped to the PydanticObjectId class"
      },
      "OpenaiApiConversationHistoryMeta": {
        "properties": { "source": { "type": "string", "enum": ["openai_api"], "title": "Source" } },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiApiConversationHistoryMeta"
      },
      "OpenaiApiConversationSchema": {
        "properties": {
          "id": { "type": "integer", "title": "Id", "default": -1 },
          "source": { "type": "string", "enum": ["openai_api"], "title": "Source" },
          "conversation_id": { "type": "string", "format": "uuid", "title": "Conversation Id" },
          "title": { "type": "string", "title": "Title" },
          "user_id": { "type": "integer", "title": "User Id" },
          "is_valid": { "type": "boolean", "title": "Is Valid", "default": true },
          "current_model": { "type": "string", "title": "Current Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" }
        },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiApiConversationSchema"
      },
      "OpenaiApiPerModelAskCount": {
        "additionalProperties": { "type": "integer" },
        "type": "object",
        "title": "OpenaiApiPerModelAskCount",
        "default": { "gpt_3_5": 0, "gpt_4": 0 }
      },
      "OpenaiApiSetting": {
        "properties": {
          "enabled": { "type": "boolean", "title": "Enabled", "default": true },
          "openai_base_url": { "type": "string", "title": "Openai Base Url", "default": "https://api.openai.com/v1/" },
          "proxy": { "type": "string", "title": "Proxy" },
          "connect_timeout": { "type": "integer", "minimum": 1.0, "title": "Connect Timeout", "default": 10 },
          "read_timeout": { "type": "integer", "minimum": 1.0, "title": "Read Timeout", "default": 20 },
          "enabled_models": {
            "items": { "$ref": "#/components/schemas/OpenaiApiChatModels" },
            "type": "array",
            "default": ["gpt_3_5", "gpt_4"]
          },
          "model_code_mapping": {
            "additionalProperties": { "type": "string" },
            "type": "object",
            "title": "Model Code Mapping",
            "default": { "gpt_3_5": "gpt-3.5-turbo", "gpt_4": "gpt-4" }
          }
        },
        "type": "object",
        "title": "OpenaiApiSetting"
      },
      "OpenaiApiSourceSettingSchema": {
        "properties": {
          "allow_to_use": { "type": "boolean", "title": "Allow To Use" },
          "valid_until": { "type": "string", "format": "date-time", "title": "Valid Until" },
          "max_conv_count": { "type": "integer", "title": "Max Conv Count" },
          "total_ask_count": { "type": "integer", "title": "Total Ask Count" },
          "rate_limits": {
            "items": { "$ref": "#/components/schemas/TimeWindowRateLimit" },
            "type": "array",
            "title": "Rate Limits"
          },
          "daily_available_time_slots": {
            "items": { "$ref": "#/components/schemas/DailyTimeSlot" },
            "type": "array",
            "title": "Daily Available Time Slots"
          },
          "available_models": { "items": { "$ref": "#/components/schemas/OpenaiApiChatModels" }, "type": "array" },
          "per_model_ask_count": { "$ref": "#/components/schemas/OpenaiApiPerModelAskCount" },
          "allow_custom_openai_api": { "type": "boolean", "title": "Allow Custom Openai Api" },
          "custom_openai_api_settings": { "$ref": "#/components/schemas/CustomOpenaiApiSettings" }
        },
        "type": "object",
        "required": [
          "allow_to_use",
          "max_conv_count",
          "total_ask_count",
          "rate_limits",
          "daily_available_time_slots",
          "available_models",
          "per_model_ask_count",
          "allow_custom_openai_api",
          "custom_openai_api_settings"
        ],
        "title": "OpenaiApiSourceSettingSchema"
      },
      "OpenaiChatFileUploadInfo": {
        "properties": {
          "file_name": { "type": "string", "title": "File Name" },
          "file_size": { "type": "integer", "title": "File Size" },
          "use_case": { "type": "string", "enum": ["ace_upload", "multimodal"], "title": "Use Case" }
        },
        "type": "object",
        "required": ["file_name", "file_size", "use_case"],
        "title": "OpenaiChatFileUploadInfo"
      },
      "OpenaiChatInterpreterInfo": {
        "properties": {
          "kernel_started": { "type": "boolean", "title": "Kernel Started" },
          "time_remaining_ms": { "type": "integer", "title": "Time Remaining Ms" }
        },
        "type": "object",
        "title": "OpenaiChatInterpreterInfo"
      },
      "OpenaiChatPlugin": {
        "properties": {
          "id": { "type": "string", "title": "Id" },
          "namespace": { "type": "string", "title": "Namespace" },
          "manifest": { "$ref": "#/components/schemas/OpenaiChatPluginManifest" },
          "categories": {
            "items": { "$ref": "#/components/schemas/OpenaiChatPluginCategory" },
            "type": "array",
            "title": "Categories"
          },
          "domain": { "type": "string", "title": "Domain" },
          "status": { "anyOf": [{ "type": "string", "enum": ["approved"] }, { "type": "string" }], "title": "Status" },
          "user_settings": {
            "anyOf": [{ "$ref": "#/components/schemas/OpenaiChatPluginUserSettings" }, { "type": "object" }],
            "title": "User Settings"
          },
          "oauth_client_id": { "type": "string", "title": "Oauth Client Id" }
        },
        "type": "object",
        "title": "OpenaiChatPlugin"
      },
      "OpenaiChatPluginCategory": {
        "properties": { "id": { "type": "string", "title": "Id" }, "title": { "type": "string", "title": "Title" } },
        "type": "object",
        "title": "OpenaiChatPluginCategory"
      },
      "OpenaiChatPluginManifest": {
        "properties": {
          "api": { "type": "object", "title": "Api" },
          "auth": { "type": "object", "title": "Auth" },
          "logo_url": { "type": "string", "title": "Logo Url" },
          "contact_email": { "type": "string", "title": "Contact Email" },
          "schema_version": { "type": "string", "title": "Schema Version" },
          "name_for_model": { "type": "string", "title": "Name For Model" },
          "name_for_human": { "type": "string", "title": "Name For Human" },
          "description_for_model": { "type": "string", "title": "Description For Model" },
          "description_for_human": { "type": "string", "title": "Description For Human" },
          "legal_info_url": { "type": "string", "title": "Legal Info Url" }
        },
        "type": "object",
        "title": "OpenaiChatPluginManifest"
      },
      "OpenaiChatPluginUserSettings": {
        "properties": {
          "is_authenticated": { "type": "boolean", "title": "Is Authenticated" },
          "is_installed": { "type": "boolean", "title": "Is Installed" }
        },
        "type": "object",
        "title": "OpenaiChatPluginUserSettings"
      },
      "OpenaiChatResponseUsage": {
        "properties": {
          "prompt_tokens": { "type": "integer", "title": "Prompt Tokens" },
          "completion_tokens": { "type": "integer", "title": "Completion Tokens" }
        },
        "type": "object",
        "title": "OpenaiChatResponseUsage"
      },
      "OpenaiWebAskAttachment": {
        "properties": {
          "name": { "type": "string", "title": "Name" },
          "id": { "type": "string", "title": "Id" },
          "size": { "type": "integer", "title": "Size" }
        },
        "type": "object",
        "required": ["name", "id", "size"],
        "title": "OpenaiWebAskAttachment"
      },
      "OpenaiWebAskLogMeta": {
        "properties": {
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "model": { "$ref": "#/components/schemas/OpenaiWebChatModels" }
        },
        "type": "object",
        "required": ["source", "model"],
        "title": "OpenaiWebAskLogMeta"
      },
      "OpenaiWebChatGPTSetting": {
        "properties": {
          "enabled": { "type": "boolean", "title": "Enabled", "default": true },
          "is_plus_account": { "type": "boolean", "title": "Is Plus Account", "default": true },
          "chatgpt_base_url": { "type": "string", "title": "Chatgpt Base Url" },
          "proxy": { "type": "string", "title": "Proxy" },
          "common_timeout": { "type": "integer", "minimum": 1.0, "title": "Common Timeout", "default": 20 },
          "ask_timeout": { "type": "integer", "minimum": 1.0, "title": "Ask Timeout", "default": 600 },
          "sync_conversations_on_startup": {
            "type": "boolean",
            "title": "Sync Conversations On Startup",
            "default": true
          },
          "sync_conversations_schedule": {
            "type": "boolean",
            "title": "Sync Conversations Schedule",
            "default": false
          },
          "sync_conversations_schedule_interval_hours": {
            "type": "integer",
            "minimum": 1.0,
            "title": "Sync Conversations Schedule Interval Hours",
            "default": 12
          },
          "enabled_models": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatModels" },
            "type": "array",
            "default": ["gpt_3_5", "gpt_4", "gpt_4_code_interpreter", "gpt_4_plugins", "gpt_4_browsing"]
          },
          "model_code_mapping": {
            "additionalProperties": { "type": "string" },
            "type": "object",
            "title": "Model Code Mapping",
            "default": {
              "gpt_3_5": "text-davinci-002-render-sha",
              "gpt_3_5_mobile": "text-davinci-002-render-sha-mobile",
              "gpt_4": "gpt-4",
              "gpt_4_mobile": "gpt-4-mobile",
              "gpt_4_browsing": "gpt-4-browsing",
              "gpt_4_plugins": "gpt-4-plugins",
              "gpt_4_code_interpreter": "gpt-4-code-interpreter",
              "gpt_4_dalle": "gpt-4-dalle"
            }
          },
          "file_upload_strategy": {
            "allOf": [{ "$ref": "#/components/schemas/OpenaiWebFileUploadStrategyOption" }],
            "default": "browser_upload_only"
          },
          "enable_uploading_attachments": {
            "type": "boolean",
            "title": "Enable Uploading Attachments",
            "default": true
          },
          "enable_uploading_multimodal_images": {
            "type": "boolean",
            "title": "Enable Uploading Multimodal Images",
            "default": true
          }
        },
        "type": "object",
        "title": "OpenaiWebChatGPTSetting"
      },
      "OpenaiWebChatMessage": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "role": {
            "anyOf": [{ "type": "string", "enum": ["system", "user", "assistant", "tool"] }, { "type": "string" }],
            "title": "Role"
          },
          "author_name": {
            "anyOf": [{ "type": "string", "enum": ["browser", "python"] }, { "type": "string" }],
            "title": "Author Name"
          },
          "model": { "type": "string", "title": "Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "parent": { "type": "string", "format": "uuid", "title": "Parent" },
          "children": { "items": { "type": "string", "format": "uuid" }, "type": "array", "title": "Children" },
          "content": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebChatMessageTextContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageCodeContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageExecutionOutputContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageStderrContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageTetherBrowsingDisplayContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageTetherQuoteContent" },
              { "$ref": "#/components/schemas/OpenaiWebChatMessageSystemErrorContent" }
            ],
            "title": "Content"
          },
          "metadata": {
            "anyOf": [
              { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadata" },
              { "$ref": "#/components/schemas/OpenaiApiChatMessageMetadata" }
            ],
            "title": "Metadata"
          }
        },
        "type": "object",
        "required": ["id", "source", "role", "children"],
        "title": "OpenaiWebChatMessage"
      },
      "OpenaiWebChatMessageCodeContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["code"], "title": "Content Type" },
          "language": { "type": "string", "title": "Language" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageCodeContent"
      },
      "OpenaiWebChatMessageExecutionOutputContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["execution_output"], "title": "Content Type" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageExecutionOutputContent"
      },
      "OpenaiWebChatMessageMetadata": {
        "properties": {
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "finish_details": { "type": "object", "title": "Finish Details" },
          "weight": { "type": "number", "title": "Weight" },
          "end_turn": { "type": "boolean", "title": "End Turn" },
          "message_status": { "type": "string", "title": "Message Status" },
          "recipient": {
            "anyOf": [{ "type": "string", "enum": ["all", "browser", "python"] }, { "type": "string" }],
            "title": "Recipient"
          },
          "fallback_content": { "title": "Fallback Content" },
          "invoked_plugin": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataPlugin" },
          "command": { "anyOf": [{ "type": "string", "enum": ["search"] }, { "type": "string" }], "title": "Command" },
          "args": { "items": { "type": "string" }, "type": "array", "title": "Args" },
          "status": { "anyOf": [{ "type": "string", "enum": ["finished"] }, { "type": "string" }], "title": "Status" },
          "_cite_metadata": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataCite" },
          "citations": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataCitation" },
            "type": "array",
            "title": "Citations"
          },
          "attachments": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataAttachment" },
            "type": "array",
            "title": "Attachments"
          },
          "is_complete": { "type": "boolean", "title": "Is Complete" },
          "aggregate_result": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataAggregateResult" }
        },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiWebChatMessageMetadata"
      },
      "OpenaiWebChatMessageMetadataAggregateResult": {
        "properties": {
          "status": {
            "anyOf": [
              { "type": "string", "enum": ["failed_with_in_kernel_exception", "success"] },
              { "type": "string" }
            ],
            "title": "Status"
          },
          "run_id": { "type": "string", "title": "Run Id" },
          "start_time": { "type": "number", "title": "Start Time" },
          "update_time": { "type": "number", "title": "Update Time" },
          "end_time": { "type": "number", "title": "End Time" },
          "final_expression_output": { "title": "Final Expression Output" },
          "code": { "type": "string", "title": "Code" },
          "in_kernel_exception": { "type": "object", "title": "In Kernel Exception" },
          "messages": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataAggregateResultMessage" },
            "type": "array",
            "title": "Messages"
          },
          "jupyter_messages": { "items": {}, "type": "array", "title": "Jupyter Messages" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataAggregateResult"
      },
      "OpenaiWebChatMessageMetadataAggregateResultMessage": {
        "properties": {
          "message_type": {
            "anyOf": [{ "type": "string", "enum": ["image", "stream"] }, { "type": "string" }],
            "title": "Message Type"
          },
          "time": { "type": "number", "title": "Time" },
          "sender": { "anyOf": [{ "type": "string", "enum": ["server"] }, { "type": "string" }], "title": "Sender" },
          "image_url": { "type": "string", "title": "Image Url" },
          "stream_name": { "type": "string", "title": "Stream Name" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataAggregateResultMessage"
      },
      "OpenaiWebChatMessageMetadataAttachment": {
        "properties": {
          "name": { "type": "string", "title": "Name" },
          "id": { "type": "string", "title": "Id" },
          "size": { "type": "integer", "title": "Size" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataAttachment"
      },
      "OpenaiWebChatMessageMetadataCitation": {
        "properties": {
          "start_ix": { "type": "integer", "title": "Start Ix" },
          "end_ix": { "type": "integer", "title": "End Ix" },
          "metadata": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataCiteData" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataCitation"
      },
      "OpenaiWebChatMessageMetadataCite": {
        "properties": {
          "citation_format": { "type": "object", "title": "Citation Format" },
          "metadata_list": {
            "items": { "$ref": "#/components/schemas/OpenaiWebChatMessageMetadataCiteData" },
            "type": "array",
            "title": "Metadata List"
          }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataCite"
      },
      "OpenaiWebChatMessageMetadataCiteData": {
        "properties": {
          "title": { "type": "string", "title": "Title" },
          "url": { "type": "string", "title": "Url" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataCiteData"
      },
      "OpenaiWebChatMessageMetadataPlugin": {
        "properties": {
          "http_response_status": { "type": "integer", "title": "Http Response Status" },
          "namespace": { "type": "string", "title": "Namespace" },
          "plugin_id": { "type": "string", "title": "Plugin Id" },
          "type": { "type": "string", "title": "Type" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMetadataPlugin"
      },
      "OpenaiWebChatMessageMultimodalTextContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["multimodal_text"], "title": "Content Type" },
          "parts": {
            "items": {
              "anyOf": [
                { "type": "string" },
                { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextContentImagePart" },
                {}
              ]
            },
            "type": "array",
            "title": "Parts"
          }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageMultimodalTextContent"
      },
      "OpenaiWebChatMessageMultimodalTextContentImagePart": {
        "properties": {
          "asset_pointer": { "type": "string", "title": "Asset Pointer" },
          "size_bytes": { "type": "integer", "title": "Size Bytes" },
          "width": { "type": "integer", "title": "Width" },
          "height": { "type": "integer", "title": "Height" },
          "metadata": { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextMetadata" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMultimodalTextContentImagePart"
      },
      "OpenaiWebChatMessageMultimodalTextMetadata": {
        "properties": { "dalle": { "$ref": "#/components/schemas/OpenaiWebChatMessageMultimodalTextMetadataDalle" } },
        "type": "object",
        "title": "OpenaiWebChatMessageMultimodalTextMetadata"
      },
      "OpenaiWebChatMessageMultimodalTextMetadataDalle": {
        "properties": {
          "prompt": { "type": "string", "title": "Prompt" },
          "seed": { "type": "integer", "title": "Seed" },
          "serialization_title": { "type": "string", "title": "Serialization Title" }
        },
        "type": "object",
        "title": "OpenaiWebChatMessageMultimodalTextMetadataDalle"
      },
      "OpenaiWebChatMessageStderrContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["stderr"], "title": "Content Type" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageStderrContent"
      },
      "OpenaiWebChatMessageSystemErrorContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["system_error"], "title": "Content Type" },
          "name": { "anyOf": [{ "type": "string", "enum": ["tool_error"] }, { "type": "string" }], "title": "Name" },
          "text": { "type": "string", "title": "Text" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageSystemErrorContent"
      },
      "OpenaiWebChatMessageTetherBrowsingDisplayContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["tether_browsing_display"], "title": "Content Type" },
          "result": { "type": "string", "title": "Result" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageTetherBrowsingDisplayContent"
      },
      "OpenaiWebChatMessageTetherQuoteContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["tether_quote"], "title": "Content Type" },
          "url": { "type": "string", "title": "Url" },
          "domain": { "type": "string", "title": "Domain" },
          "text": { "type": "string", "title": "Text" },
          "title": { "type": "string", "title": "Title" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageTetherQuoteContent"
      },
      "OpenaiWebChatMessageTextContent": {
        "properties": {
          "content_type": { "type": "string", "enum": ["text"], "title": "Content Type" },
          "parts": { "items": { "type": "string" }, "type": "array", "title": "Parts" }
        },
        "type": "object",
        "required": ["content_type"],
        "title": "OpenaiWebChatMessageTextContent"
      },
      "OpenaiWebChatModels": {
        "type": "string",
        "enum": [
          "gpt_3_5",
          "gpt_3_5_mobile",
          "gpt_4",
          "gpt_4_mobile",
          "gpt_4_browsing",
          "gpt_4_code_interpreter",
          "gpt_4_plugins",
          "gpt_4_dalle"
        ],
        "title": "OpenaiWebChatModels",
        "description": "An enumeration."
      },
      "OpenaiWebChatStatus": {
        "type": "string",
        "enum": ["asking", "queueing", "idling"],
        "title": "OpenaiWebChatStatus",
        "description": "An enumeration."
      },
      "OpenaiWebConversationHistoryDocument": {
        "properties": {
          "_id": { "type": "string", "format": "uuid", "title": " Id" },
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "title": { "type": "string", "title": "Title" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" },
          "mapping": {
            "additionalProperties": { "$ref": "#/components/schemas/OpenaiWebChatMessage" },
            "type": "object",
            "title": "Mapping"
          },
          "current_node": { "type": "string", "format": "uuid", "title": "Current Node" },
          "current_model": { "type": "string", "title": "Current Model" },
          "metadata": { "$ref": "#/components/schemas/OpenaiWebConversationHistoryMeta" }
        },
        "type": "object",
        "required": ["source", "title", "create_time", "update_time", "mapping"],
        "title": "OpenaiWebConversationHistoryDocument",
        "description": "Document Mapping class.\n\nFields:\n\n- `id` - MongoDB document ObjectID \"_id\" field.\nMapped to the PydanticObjectId class"
      },
      "OpenaiWebConversationHistoryMeta": {
        "properties": {
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "moderation_results": { "items": {}, "type": "array", "title": "Moderation Results" },
          "plugin_ids": { "items": { "type": "string" }, "type": "array", "title": "Plugin Ids" }
        },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiWebConversationHistoryMeta"
      },
      "OpenaiWebConversationSchema": {
        "properties": {
          "id": { "type": "integer", "title": "Id", "default": -1 },
          "source": { "type": "string", "enum": ["openai_web"], "title": "Source" },
          "conversation_id": { "type": "string", "format": "uuid", "title": "Conversation Id" },
          "title": { "type": "string", "title": "Title" },
          "user_id": { "type": "integer", "title": "User Id" },
          "is_valid": { "type": "boolean", "title": "Is Valid", "default": true },
          "current_model": { "type": "string", "title": "Current Model" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "update_time": { "type": "string", "format": "date-time", "title": "Update Time" }
        },
        "type": "object",
        "required": ["source"],
        "title": "OpenaiWebConversationSchema"
      },
      "OpenaiWebFileUploadStrategyOption": {
        "type": "string",
        "enum": ["server_upload_only", "browser_upload_only", "browser_upload_when_file_size_exceed"],
        "title": "OpenaiWebFileUploadStrategyOption",
        "description": "An enumeration."
      },
      "OpenaiWebPerModelAskCount": {
        "additionalProperties": { "type": "integer" },
        "type": "object",
        "title": "OpenaiWebPerModelAskCount",
        "default": {
          "gpt_3_5": 0,
          "gpt_3_5_mobile": 0,
          "gpt_4": 0,
          "gpt_4_mobile": 0,
          "gpt_4_browsing": 0,
          "gpt_4_code_interpreter": 0,
          "gpt_4_plugins": 0,
          "gpt_4_dalle": 0
        }
      },
      "OpenaiWebSourceSettingSchema": {
        "properties": {
          "allow_to_use": { "type": "boolean", "title": "Allow To Use" },
          "valid_until": { "type": "string", "format": "date-time", "title": "Valid Until" },
          "max_conv_count": { "type": "integer", "title": "Max Conv Count" },
          "total_ask_count": { "type": "integer", "title": "Total Ask Count" },
          "rate_limits": {
            "items": { "$ref": "#/components/schemas/TimeWindowRateLimit" },
            "type": "array",
            "title": "Rate Limits"
          },
          "daily_available_time_slots": {
            "items": { "$ref": "#/components/schemas/DailyTimeSlot" },
            "type": "array",
            "title": "Daily Available Time Slots"
          },
          "available_models": { "items": { "$ref": "#/components/schemas/OpenaiWebChatModels" }, "type": "array" },
          "per_model_ask_count": { "$ref": "#/components/schemas/OpenaiWebPerModelAskCount" },
          "allow_uploading_attachments": { "type": "boolean", "title": "Allow Uploading Attachments" },
          "allow_uploading_multimodal_images": { "type": "boolean", "title": "Allow Uploading Multimodal Images" }
        },
        "type": "object",
        "required": [
          "allow_to_use",
          "max_conv_count",
          "total_ask_count",
          "rate_limits",
          "daily_available_time_slots",
          "available_models",
          "per_model_ask_count",
          "allow_uploading_attachments",
          "allow_uploading_multimodal_images"
        ],
        "title": "OpenaiWebSourceSettingSchema"
      },
      "RequestLogAggregation": {
        "properties": {
          "_id": { "$ref": "#/components/schemas/RequestLogAggregationID" },
          "count": { "type": "integer", "title": "Count" },
          "user_ids": { "items": { "type": "integer" }, "type": "array", "title": "User Ids" },
          "avg_elapsed_ms": { "type": "number", "title": "Avg Elapsed Ms" }
        },
        "type": "object",
        "required": ["_id", "count"],
        "title": "RequestLogAggregation"
      },
      "RequestLogAggregationID": {
        "properties": {
          "start_time": { "type": "string", "format": "date-time", "title": "Start Time" },
          "route_path": { "type": "string", "title": "Route Path" },
          "method": { "type": "string", "title": "Method" }
        },
        "type": "object",
        "title": "RequestLogAggregationID"
      },
      "StartUploadResponseSchema": {
        "properties": {
          "strategy": { "$ref": "#/components/schemas/OpenaiWebFileUploadStrategyOption" },
          "file_max_size": { "type": "integer", "title": "File Max Size" },
          "upload_file_info": { "$ref": "#/components/schemas/UploadedFileInfoSchema" }
        },
        "type": "object",
        "required": ["strategy", "file_max_size"],
        "title": "StartUploadResponseSchema"
      },
      "StatsSetting": {
        "properties": {
          "ask_stats_ttl": { "type": "integer", "title": "Ask Stats Ttl", "default": 7776000 },
          "request_stats_ttl": { "type": "integer", "title": "Request Stats Ttl", "default": 2592000 },
          "request_stats_filter_keywords": {
            "items": { "type": "string" },
            "type": "array",
            "title": "Request Stats Filter Keywords",
            "default": ["/status"]
          }
        },
        "type": "object",
        "title": "StatsSetting"
      },
      "SystemInfo": {
        "properties": {
          "startup_time": { "type": "number", "title": "Startup Time" },
          "total_user_count": { "type": "integer", "title": "Total User Count" },
          "total_conversation_count": { "type": "integer", "title": "Total Conversation Count" },
          "valid_conversation_count": { "type": "integer", "title": "Valid Conversation Count" }
        },
        "type": "object",
        "required": ["startup_time", "total_user_count", "total_conversation_count", "valid_conversation_count"],
        "title": "SystemInfo"
      },
      "TimeWindowRateLimit": {
        "properties": {
          "window_seconds": { "type": "integer", "title": "Window Seconds", "description": "时间窗口大小，单位为秒" },
          "max_requests": {
            "type": "integer",
            "title": "Max Requests",
            "description": "在给定时间窗口内最多的请求次数"
          }
        },
        "type": "object",
        "required": ["window_seconds", "max_requests"],
        "title": "TimeWindowRateLimit"
      },
      "UploadedFileInfoSchema": {
        "properties": {
          "id": { "type": "string", "format": "uuid", "title": "Id" },
          "original_filename": { "type": "string", "title": "Original Filename" },
          "size": { "type": "integer", "title": "Size" },
          "storage_path": { "type": "string", "title": "Storage Path" },
          "content_type": { "type": "string", "title": "Content Type" },
          "upload_time": { "type": "string", "format": "date-time", "title": "Upload Time" },
          "uploader_id": { "type": "integer", "title": "Uploader Id" },
          "openai_web_info": { "$ref": "#/components/schemas/UploadedFileOpenaiWebInfo" }
        },
        "type": "object",
        "required": ["id", "original_filename", "size", "upload_time", "uploader_id"],
        "title": "UploadedFileInfoSchema"
      },
      "UploadedFileOpenaiWebInfo": {
        "properties": {
          "file_id": { "type": "string", "title": "File Id" },
          "use_case": {
            "anyOf": [{ "type": "string", "enum": ["ace_upload", "multimodal"] }, { "type": "string" }],
            "title": "Use Case"
          },
          "upload_url": { "type": "string", "title": "Upload Url", "description": "上传文件的url, 上传后应清空该字段" },
          "download_url": { "type": "string", "title": "Download Url" }
        },
        "type": "object",
        "title": "UploadedFileOpenaiWebInfo"
      },
      "UserCreate": {
        "properties": {
          "email": { "type": "string", "format": "email", "title": "Email" },
          "password": { "type": "string", "title": "Password" },
          "is_active": { "type": "boolean", "title": "Is Active", "default": true },
          "is_superuser": { "type": "boolean", "title": "Is Superuser", "default": false },
          "is_verified": { "type": "boolean", "title": "Is Verified", "default": false },
          "username": { "type": "string", "title": "Username" },
          "nickname": { "type": "string", "title": "Nickname" },
          "avatar": { "type": "string", "title": "Avatar" },
          "remark": { "type": "string", "title": "Remark" }
        },
        "type": "object",
        "required": ["email", "password", "username", "nickname"],
        "title": "UserCreate"
      },
      "UserRead": {
        "properties": {
          "id": { "type": "integer", "title": "Id" },
          "email": { "type": "string", "format": "email", "title": "Email" },
          "is_active": { "type": "boolean", "title": "Is Active" },
          "is_superuser": { "type": "boolean", "title": "Is Superuser" },
          "is_verified": { "type": "boolean", "title": "Is Verified" },
          "username": { "type": "string", "title": "Username" },
          "nickname": { "type": "string", "title": "Nickname" },
          "last_active_time": { "type": "string", "format": "date-time", "title": "Last Active Time" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "avatar": { "type": "string", "title": "Avatar" },
          "setting": { "$ref": "#/components/schemas/UserSettingSchema" }
        },
        "type": "object",
        "required": [
          "id",
          "email",
          "is_active",
          "is_superuser",
          "is_verified",
          "username",
          "nickname",
          "create_time",
          "setting"
        ],
        "title": "UserRead",
        "description": "Base User model."
      },
      "UserReadAdmin": {
        "properties": {
          "id": { "type": "integer", "title": "Id" },
          "email": { "type": "string", "format": "email", "title": "Email" },
          "is_active": { "type": "boolean", "title": "Is Active" },
          "is_superuser": { "type": "boolean", "title": "Is Superuser" },
          "is_verified": { "type": "boolean", "title": "Is Verified" },
          "username": { "type": "string", "title": "Username" },
          "nickname": { "type": "string", "title": "Nickname" },
          "last_active_time": { "type": "string", "format": "date-time", "title": "Last Active Time" },
          "create_time": { "type": "string", "format": "date-time", "title": "Create Time" },
          "avatar": { "type": "string", "title": "Avatar" },
          "setting": { "$ref": "#/components/schemas/UserSettingSchema" },
          "remark": { "type": "string", "title": "Remark" }
        },
        "type": "object",
        "required": [
          "id",
          "email",
          "is_active",
          "is_superuser",
          "is_verified",
          "username",
          "nickname",
          "create_time",
          "setting"
        ],
        "title": "UserReadAdmin",
        "description": "Base User model."
      },
      "UserSettingSchema": {
        "properties": {
          "id": { "type": "integer", "title": "Id" },
          "user_id": { "type": "integer", "title": "User Id" },
          "credits": { "type": "number", "title": "Credits" },
          "openai_web_chat_status": { "$ref": "#/components/schemas/OpenaiWebChatStatus" },
          "openai_web": { "$ref": "#/components/schemas/OpenaiWebSourceSettingSchema" },
          "openai_api": { "$ref": "#/components/schemas/OpenaiApiSourceSettingSchema" }
        },
        "type": "object",
        "required": ["credits", "openai_web_chat_status", "openai_web", "openai_api"],
        "title": "UserSettingSchema"
      },
      "UserUpdate": {
        "properties": {
          "password": { "type": "string", "title": "Password" },
          "email": { "type": "string", "title": "Email" },
          "is_active": { "type": "boolean", "title": "Is Active" },
          "is_superuser": { "type": "boolean", "title": "Is Superuser" },
          "is_verified": { "type": "boolean", "title": "Is Verified" },
          "nickname": { "type": "string", "title": "Nickname" },
          "avatar": { "type": "string", "title": "Avatar" }
        },
        "type": "object",
        "title": "UserUpdate"
      },
      "UserUpdateAdmin": {
        "properties": {
          "password": { "type": "string", "title": "Password" },
          "email": { "type": "string", "title": "Email" },
          "is_active": { "type": "boolean", "title": "Is Active" },
          "is_superuser": { "type": "boolean", "title": "Is Superuser" },
          "is_verified": { "type": "boolean", "title": "Is Verified" },
          "nickname": { "type": "string", "title": "Nickname" },
          "avatar": { "type": "string", "title": "Avatar" },
          "username": { "type": "string", "title": "Username" },
          "remark": { "type": "string", "title": "Remark" }
        },
        "type": "object",
        "title": "UserUpdateAdmin"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": { "anyOf": [{ "type": "string" }, { "type": "integer" }] },
            "type": "array",
            "title": "Location"
          },
          "msg": { "type": "string", "title": "Message" },
          "type": { "type": "string", "title": "Error Type" }
        },
        "type": "object",
        "required": ["loc", "msg", "type"],
        "title": "ValidationError"
      }
    },
    "securitySchemes": { "APIKeyCookie": { "type": "apiKey", "in": "cookie", "name": "cws_user_auth" } }
  }
}
